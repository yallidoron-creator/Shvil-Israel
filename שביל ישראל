<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>×©×‘×™×œ ×™×©×¨××œ | ×”×“×¨×•×</title>
<link href="https://fonts.googleapis.com/css2?family=Frank+Ruhl+Libre:wght@400;700;900&family=Heebo:wght@300;400;500;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<style>
:root{
  --sand:#E8D5B0;--tc:#C4612A;--rust:#8B3A1A;
  --sky:#6BA4C4;--sage:#7A9B6E;--dark:#0E0904;
  --cream:#F5EDD8;--orange:#E8873A;--wt:#F0EDE4;--bt:#4A7FB5;
  --panel:rgba(10,6,1,0.97);--gold:#D4A843;
}
*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'Heebo',sans-serif;background:var(--dark);color:var(--cream);height:100vh;overflow:hidden;}

/* HEADER */
.hdr{position:fixed;inset:0 0 auto 0;z-index:3000;height:54px;background:rgba(8,4,0,.97);backdrop-filter:blur(20px);border-bottom:1px solid rgba(196,97,42,.22);display:flex;align-items:center;justify-content:space-between;padding:0 1rem;}
.logo{display:flex;align-items:center;gap:8px;}
.tm{display:flex;gap:2px;}.tm span{width:5px;height:20px;border-radius:2px;}
.tm .w{background:var(--wt);}.tm .b{background:var(--bt);}.tm .o{background:var(--orange);}
.lt{font-family:'Frank Ruhl Libre',serif;font-size:.88rem;font-weight:700;line-height:1.1;}
.ls{font-size:.55rem;color:var(--orange);}
.nav{display:flex;gap:2px;}
.nb{padding:4px 10px;border-radius:14px;border:1px solid transparent;cursor:pointer;font-family:'Heebo',sans-serif;font-size:.7rem;font-weight:500;transition:all .2s;background:transparent;color:var(--sand);white-space:nowrap;}
.nb:hover{border-color:var(--tc);color:var(--orange);}
.nb.on{background:var(--tc);color:var(--cream);border-color:var(--tc);}

.wrap{padding-top:54px;height:100vh;}
.view{display:none;height:calc(100vh - 54px);}
.view.on{display:flex;}

/* â•â• MAP â•â• */
#vmap{position:relative;overflow:hidden;}
#spni-map{position:absolute;inset:0 0 0 0;width:calc(100% - 290px);height:100%;border:none;z-index:1;}

/* right sections panel â€“ always visible, no toggle */
.map-sec-panel{
  position:absolute;top:0;bottom:0;right:0;width:290px;z-index:500;
  background:rgba(8,4,0,.96);border-left:1px solid rgba(196,97,42,.22);
  display:flex;flex-direction:column;overflow:hidden;
}
.msp-head{
  padding:8px 13px 6px;border-bottom:1px solid rgba(196,97,42,.2);
  font-family:'Frank Ruhl Libre',serif;font-size:.82rem;color:var(--orange);
  flex-shrink:0;display:flex;align-items:center;justify-content:space-between;
}
.msp-sub{font-size:.55rem;color:var(--sand);opacity:.5;font-family:'Heebo',sans-serif;}
.dir-toggle{display:flex;gap:3px;}
.dtb{padding:2px 7px;border-radius:8px;border:1px solid rgba(196,97,42,.25);background:transparent;color:var(--sand);font-size:.6rem;cursor:pointer;font-family:'Heebo',sans-serif;transition:all .15s;}
.dtb.on{background:var(--tc);color:white;border-color:var(--tc);}
.msp-list{flex:1;overflow-y:auto;padding:3px 0;}
.msp-list::-webkit-scrollbar{width:3px;}
.msp-list::-webkit-scrollbar-thumb{background:rgba(196,97,42,.25);}
.msp-item{padding:7px 11px;border-bottom:1px solid rgba(255,255,255,.04);cursor:pointer;transition:all .15s;}
.msp-item:hover,.msp-item.on{background:rgba(196,97,42,.14);}
.msp-item.on{border-right:3px solid var(--tc);}
.msp-num{font-size:.52rem;color:var(--orange);font-weight:700;margin-bottom:1px;}
.msp-name{font-size:.74rem;color:var(--cream);font-weight:500;margin-bottom:2px;}
.msp-km{font-size:.6rem;color:var(--sand);}
.msp-tags{display:flex;gap:3px;flex-wrap:wrap;margin-top:4px;}
.msp-tag{padding:1px 5px;border-radius:4px;font-size:.52rem;font-weight:500;}

/* icon bar â€“ POI only (no sections toggle) */
.map-icon-bar{
  position:absolute;top:10px;right:300px;z-index:600;
  display:flex;flex-direction:column;gap:6px;
}
.mib-btn{
  width:44px;height:44px;border-radius:13px;
  display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1px;
  background:rgba(8,4,0,.92);border:1px solid rgba(196,97,42,.25);
  backdrop-filter:blur(12px);transition:all .2s;cursor:pointer;
}
.mib-btn .mi{font-size:1.3rem;line-height:1;}
.mib-btn .ml{font-size:.4rem;color:rgba(232,213,176,.4);}
.mib-btn:hover,.mib-btn.on{background:rgba(196,97,42,.2);border-color:var(--tc);}
.mib-btn.on .ml{color:var(--orange);}

/* POI panel â€“ opens to the LEFT of icon bar */
.poi-panel{
  position:absolute;top:0;bottom:0;right:354px;width:260px;z-index:490;
  background:var(--panel);border:1px solid rgba(196,97,42,.25);border-radius:14px 0 0 14px;
  display:none;flex-direction:column;overflow-y:auto;
  box-shadow:-8px 0 32px rgba(0,0,0,.5);
}
.pp-head{padding:10px 12px 7px;border-bottom:1px solid rgba(255,255,255,.06);display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;background:var(--panel);z-index:2;}
.pp-hl{display:flex;align-items:center;gap:7px;}
.pp-ico{font-size:1.5rem;}
.pp-title{font-family:'Frank Ruhl Libre',serif;font-size:.85rem;color:var(--orange);}
.pp-sub{font-size:.57rem;color:var(--sand);opacity:.6;}
.pp-x{background:rgba(255,255,255,.06);border:none;border-radius:50%;width:22px;height:22px;cursor:pointer;color:var(--sand);font-size:.65rem;display:flex;align-items:center;justify-content:center;transition:background .2s;flex-shrink:0;}
.pp-x:hover{background:rgba(196,97,42,.35);}
.poi-card{margin:5px 7px;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.07);border-radius:10px;padding:10px;}
.pc-name{font-size:.78rem;font-weight:600;color:var(--cream);margin-bottom:2px;}
.pc-sec{font-size:.56rem;color:var(--orange);margin-bottom:3px;}
.pc-info{font-size:.68rem;color:var(--sand);line-height:1.5;}
.pc-badge{display:inline-block;padding:2px 6px;border-radius:5px;font-size:.55rem;font-weight:500;margin-top:4px;}
.pp-alert{margin:5px 7px 10px;padding:8px 9px;border-radius:9px;font-size:.65rem;line-height:1.5;}

/* section tooltip inside panel */
.msp-tooltip{background:rgba(12,6,0,.98);border-top:2px solid var(--tc);padding:11px 12px;font-family:'Heebo',sans-serif;flex-shrink:0;}

/* SCROLL VIEWS */
.scroll-view{flex-direction:column;overflow-y:auto;background:linear-gradient(158deg,#0d1208,#0a1520);padding:1.4rem;}
.iw{max-width:1100px;margin:0 auto;width:100%;}
.ivt{font-family:'Frank Ruhl Libre',serif;font-size:1.7rem;font-weight:900;text-align:center;margin-bottom:.25rem;}
.ivs{text-align:center;color:var(--sand);margin-bottom:1.4rem;font-size:.77rem;}
.ic{background:rgba(255,255,255,.04);border:1px solid rgba(196,97,42,.2);border-radius:14px;padding:1.1rem;margin-bottom:1.1rem;}
.ic h3{font-family:'Frank Ruhl Libre',serif;font-size:.95rem;color:var(--orange);margin-bottom:.75rem;}
.two{display:grid;grid-template-columns:1fr 1fr;gap:.9rem;}

/* TOOLTIP HOVER for truncated text */
[data-tip]{position:relative;cursor:help;}
[data-tip]:hover::after{
  content:attr(data-tip);
  position:absolute;bottom:calc(100% + 6px);right:0;
  background:rgba(10,5,0,.98);border:1px solid rgba(196,97,42,.4);
  color:var(--cream);font-size:.72rem;line-height:1.55;
  padding:8px 11px;border-radius:9px;white-space:pre-wrap;max-width:320px;
  z-index:9999;pointer-events:none;font-family:'Heebo',sans-serif;
  box-shadow:0 8px 24px rgba(0,0,0,.7);
}
.trunc{max-width:160px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;display:inline-block;vertical-align:bottom;}

/* TABLES */
.stbl{width:100%;border-collapse:collapse;font-size:.71rem;}
.stbl th{text-align:right;padding:6px 8px;color:var(--orange);border-bottom:1px solid rgba(196,97,42,.25);font-size:.63rem;font-weight:700;white-space:nowrap;}
.stbl td{padding:6px 8px;color:var(--sand);border-bottom:1px solid rgba(255,255,255,.05);vertical-align:top;line-height:1.6;}
.stbl td.wrap-cell{white-space:normal;word-break:break-word;min-width:100px;max-width:220px;}
.stbl td.nowrap-cell{white-space:nowrap;}
.db{display:inline-block;padding:2px 6px;border-radius:5px;font-size:.6rem;}
.de{background:rgba(122,155,110,.28);color:#9fcf8e;}
.dm{background:rgba(232,135,58,.28);color:var(--orange);}
.dh{background:rgba(139,58,26,.38);color:#ff8a5a;}

.wtbl{width:100%;border-collapse:collapse;font-size:.7rem;}
.wtbl th{text-align:right;padding:6px 8px;color:var(--orange);border-bottom:1px solid rgba(196,97,42,.25);font-size:.61rem;font-weight:700;white-space:nowrap;}
.wtbl td{padding:6px 8px;color:var(--sand);border-bottom:1px solid rgba(255,255,255,.04);vertical-align:top;line-height:1.6;white-space:normal;word-break:break-word;}
.wbadge{display:inline-block;padding:2px 6px;border-radius:5px;font-size:.55rem;font-weight:700;}

/* ANGELS */
.angel-card{background:rgba(212,168,67,.06);border:1px solid rgba(212,168,67,.2);border-radius:11px;padding:11px 13px;margin-bottom:8px;}
.angel-title{font-size:.86rem;font-weight:700;color:var(--gold);margin-bottom:2px;}
.angel-sec{font-size:.58rem;color:var(--orange);margin-bottom:4px;}
.angel-info{font-size:.71rem;color:var(--sand);line-height:1.55;}
.angel-phone{display:inline-flex;align-items:center;gap:4px;margin-top:5px;padding:3px 9px;background:rgba(122,155,110,.15);border:1px solid rgba(122,155,110,.3);border-radius:7px;font-size:.7rem;color:#9fcf8e;font-weight:600;}
.angel-note{font-size:.63rem;color:rgba(232,213,176,.45);margin-top:4px;font-style:italic;}

/* GEAR */
.gw{max-width:960px;margin:0 auto;width:100%;}
.gt{background:rgba(255,255,255,.04);border:1px solid rgba(196,97,42,.26);border-radius:13px;padding:12px 15px;margin-bottom:.8rem;}
.pns{display:flex;flex-wrap:wrap;gap:6px;margin-top:7px;}
.pnw{display:flex;align-items:center;gap:4px;}
.pcd{width:8px;height:8px;border-radius:50%;flex-shrink:0;}
.pni{background:rgba(255,255,255,.06);border:1px solid rgba(196,97,42,.22);border-radius:7px;padding:4px 7px;color:var(--cream);font-family:'Heebo',sans-serif;font-size:.74rem;width:88px;}
.pni:focus{outline:none;border-color:var(--tc);}
.ni{background:rgba(255,255,255,.08);border:1px solid rgba(196,97,42,.38);border-radius:7px;padding:4px 8px;color:var(--cream);font-family:'Heebo',sans-serif;font-size:.8rem;width:50px;text-align:center;}
.gcat{background:rgba(255,255,255,.03);border:1px solid rgba(196,97,42,.14);border-radius:12px;padding:.85rem;margin-bottom:.65rem;}
.gcat h3{font-family:'Frank Ruhl Libre',serif;font-size:.88rem;color:var(--orange);margin-bottom:.6rem;}
.gi{display:flex;align-items:center;gap:6px;padding:5px 0;border-bottom:1px solid rgba(255,255,255,.04);}
.gi:last-of-type{border-bottom:none;}
.gi.hidden-item{opacity:.2;text-decoration:line-through;}
.gn{flex:1;font-size:.77rem;color:var(--sand);}
.gn.done{text-decoration:line-through;opacity:.35;}
.g-hide-btn{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);border-radius:5px;padding:2px 6px;font-size:.55rem;color:rgba(232,213,176,.4);cursor:pointer;font-family:'Heebo',sans-serif;transition:all .15s;white-space:nowrap;flex-shrink:0;}
.g-hide-btn:hover{border-color:rgba(196,97,42,.4);color:var(--orange);}
.gi.hidden-item .g-hide-btn{color:var(--orange);border-color:var(--tc);}
/* delete button for custom items */
.g-del-btn{background:rgba(180,50,50,.1);border:1px solid rgba(180,50,50,.25);border-radius:5px;padding:2px 6px;font-size:.55rem;color:#e08080;cursor:pointer;font-family:'Heebo',sans-serif;transition:all .15s;white-space:nowrap;flex-shrink:0;}
.g-del-btn:hover{background:rgba(180,50,50,.25);border-color:#e08080;}
.gtyp{display:flex;gap:2px;}
.gtb{padding:2px 6px;border-radius:7px;border:1px solid rgba(255,255,255,.09);background:transparent;color:var(--sand);font-size:.6rem;cursor:pointer;font-family:'Heebo',sans-serif;transition:all .15s;white-space:nowrap;}
.gtb.ga{background:rgba(107,164,196,.2);border-color:var(--sky);color:var(--sky);}
.gtb.pa{background:rgba(122,155,110,.2);border-color:var(--sage);color:var(--sage);}
.gas{min-width:84px;}
.asel{background:rgba(10,6,1,.9);border:1px solid rgba(196,97,42,.28);border-radius:5px;color:var(--cream);font-family:'Heebo',sans-serif;font-size:.63rem;padding:2px 4px;width:100%;}
.add-item-row{display:flex;gap:5px;margin-top:8px;padding-top:8px;border-top:1px solid rgba(255,255,255,.06);}
.g-add-input{flex:1;background:rgba(255,255,255,.06);border:1px solid rgba(196,97,42,.25);border-radius:8px;padding:5px 8px;color:var(--cream);font-family:'Heebo',sans-serif;font-size:.75rem;}
.g-add-input:focus{outline:none;border-color:var(--tc);}
.g-add-btn{background:var(--tc);border:none;border-radius:8px;padding:5px 11px;color:white;font-family:'Heebo',sans-serif;font-size:.72rem;cursor:pointer;}
.gfooter{background:rgba(196,97,42,.08);border:1px solid rgba(196,97,42,.2);border-radius:13px;padding:14px 17px;margin-top:1rem;display:flex;gap:10px;flex-wrap:wrap;align-items:center;}
.gsi{font-size:.75rem;color:var(--sand);}.gsi strong{color:var(--orange);}
.gbtn{padding:7px 15px;border-radius:9px;border:1px solid;font-family:'Heebo',sans-serif;font-size:.74rem;cursor:pointer;transition:all .2s;font-weight:600;}
.gbtn-gold{background:rgba(212,168,67,.15);border-color:var(--gold);color:var(--gold);}
.gbtn-gold:hover{background:rgba(212,168,67,.3);}
.gbtn-sky{background:rgba(107,164,196,.15);border-color:var(--sky);color:var(--sky);}
.gbtn-sky:hover{background:rgba(107,164,196,.3);}

/* ROUTE PLANNER â€“ wizard style */
.rw{max-width:1000px;margin:0 auto;width:100%;}
.route-wizard{display:flex;gap:.8rem;height:calc(100vh - 54px - 2.8rem);overflow:hidden;}
.route-left{width:220px;flex-shrink:0;display:flex;flex-direction:column;gap:.5rem;}
.route-sec-list{flex:1;overflow-y:auto;background:rgba(255,255,255,.03);border:1px solid rgba(196,97,42,.2);border-radius:12px;}
.route-sec-list::-webkit-scrollbar{width:3px;}
.route-sec-list::-webkit-scrollbar-thumb{background:rgba(196,97,42,.25);}
.rsec-item{display:flex;align-items:center;gap:7px;padding:7px 10px;border-bottom:1px solid rgba(255,255,255,.04);cursor:pointer;transition:all .12s;}
.rsec-item:hover{background:rgba(196,97,42,.1);}
.rsec-item.sel{background:rgba(196,97,42,.22);border-right:3px solid var(--tc);}
.rsec-cb{width:14px;height:14px;border-radius:3px;border:1.5px solid rgba(196,97,42,.4);background:transparent;flex-shrink:0;display:flex;align-items:center;justify-content:center;transition:all .12s;}
.rsec-item.sel .rsec-cb{background:var(--tc);border-color:var(--tc);}
.rsec-ck{color:white;font-size:.6rem;opacity:0;}
.rsec-item.sel .rsec-ck{opacity:1;}
.rsec-num{font-size:.7rem;color:var(--orange);font-weight:700;min-width:20px;}
.rsec-name{font-size:.66rem;color:var(--cream);}
.rsec-km{font-size:.58rem;color:rgba(232,213,176,.4);}
.route-actions{display:flex;flex-direction:column;gap:5px;}
.ract{padding:7px 10px;border-radius:9px;border:1px solid;font-family:'Heebo',sans-serif;font-size:.72rem;cursor:pointer;transition:all .2s;font-weight:600;text-align:center;}
.ract-walk{background:rgba(122,155,110,.15);border-color:var(--sage);color:var(--sage);}
.ract-walk:hover{background:rgba(122,155,110,.3);}
.ract-rest{background:rgba(212,168,67,.12);border-color:var(--gold);color:var(--gold);}
.ract-rest:hover{background:rgba(212,168,67,.25);}
.ract-finish{background:rgba(196,97,42,.18);border-color:var(--tc);color:var(--orange);}
.ract-finish:hover{background:rgba(196,97,42,.35);}
.ract-reset{background:rgba(255,50,50,.07);border-color:rgba(255,100,100,.3);color:#e08080;}
.ract-reset:hover{background:rgba(255,50,50,.18);}
.ract:disabled{opacity:.3;cursor:default;}
.sel-count{font-size:.65rem;color:var(--sand);text-align:center;padding:4px;}
.route-right{flex:1;overflow-y:auto;display:flex;flex-direction:column;gap:.6rem;}
.route-day-card{background:rgba(255,255,255,.04);border:1px solid rgba(196,97,42,.2);border-radius:12px;padding:11px 14px;position:relative;}
.rdc-hdr{display:flex;align-items:center;gap:8px;margin-bottom:7px;}
.rdc-day{font-family:'Frank Ruhl Libre',serif;font-size:1rem;color:var(--orange);}
.rdc-type-badge{padding:2px 8px;border-radius:7px;font-size:.6rem;font-weight:600;}
.rdc-walk{background:rgba(122,155,110,.2);color:var(--sage);}
.rdc-rest{background:rgba(212,168,67,.15);color:var(--gold);}
.rdc-km{font-size:.66rem;color:rgba(232,213,176,.5);}
.rdc-del{position:absolute;top:8px;left:10px;background:transparent;border:none;cursor:pointer;color:rgba(232,213,176,.25);font-size:.7rem;transition:color .15s;}
.rdc-del:hover{color:#e08080;}
.rdc-secs{display:flex;flex-wrap:wrap;gap:4px;margin-bottom:6px;}
.rdc-chip{padding:2px 7px;border-radius:6px;font-size:.62rem;background:rgba(196,97,42,.18);border:1px solid rgba(196,97,42,.35);color:var(--cream);}
.rdc-info{font-size:.64rem;color:rgba(232,213,176,.5);line-height:1.5;}
.rdc-gap{margin:5px 0;padding:5px 8px;background:rgba(212,168,67,.1);border:1px solid rgba(212,168,67,.3);border-radius:7px;font-size:.63rem;color:var(--gold);}
.rdc-gap input{width:100%;background:rgba(255,255,255,.05);border:1px solid rgba(212,168,67,.25);border-radius:6px;padding:3px 7px;color:var(--cream);font-family:'Heebo',sans-serif;font-size:.67rem;margin-top:3px;}
.rdc-note{width:100%;background:rgba(255,255,255,.04);border:1px solid rgba(196,97,42,.15);border-radius:7px;padding:4px 8px;color:var(--cream);font-family:'Heebo',sans-serif;font-size:.68rem;resize:none;margin-top:5px;}
.rdc-note:focus,.rdc-gap input:focus{outline:none;border-color:var(--tc);}
.route-empty{text-align:center;color:rgba(232,213,176,.3);font-size:.8rem;padding:2rem 1rem;border:1px dashed rgba(196,97,42,.2);border-radius:12px;}
.route-finish-panel{background:rgba(122,155,110,.08);border:1px solid rgba(122,155,110,.3);border-radius:13px;padding:14px 16px;}
.rfp-stats{display:flex;gap:16px;flex-wrap:wrap;margin-bottom:10px;}
.rfp-stat{text-align:center;}
.rfp-val{font-family:'Frank Ruhl Libre',serif;font-size:1.35rem;color:var(--sage);}
.rfp-lbl{font-size:.58rem;color:var(--sand);}
.rfp-btns{display:flex;gap:7px;flex-wrap:wrap;}
.route-map-embed{width:100%;height:280px;border:1px solid rgba(196,97,42,.2);border-radius:11px;overflow:hidden;margin-top:.6rem;}
.route-map-embed iframe{width:100%;height:100%;border:none;}

/* PAID CONTACTS */
.paid-card{background:rgba(212,168,67,.05);border:1px solid rgba(212,168,67,.22);border-radius:10px;padding:10px 12px;margin-bottom:7px;}
.paid-name{font-size:.83rem;font-weight:700;color:var(--gold);}
.paid-phone{display:inline-flex;align-items:center;gap:4px;margin-top:4px;padding:3px 9px;background:rgba(212,168,67,.15);border:1px solid rgba(212,168,67,.35);border-radius:7px;font-size:.72rem;color:var(--gold);font-weight:700;}
.paid-srv{font-size:.68rem;color:var(--sand);margin-top:4px;line-height:1.5;}

/* MODALS */
.modal{position:fixed;inset:0;z-index:9000;background:rgba(0,0,0,.75);display:flex;align-items:center;justify-content:center;backdrop-filter:blur(5px);}
.modal-inner{background:rgba(12,8,2,.98);border:1px solid rgba(196,97,42,.4);border-radius:18px;padding:20px;width:92%;max-width:720px;max-height:85vh;overflow-y:auto;}
.modal-inner h2{font-family:'Frank Ruhl Libre',serif;font-size:1.1rem;color:var(--orange);margin-bottom:10px;}
.etbl{width:100%;border-collapse:collapse;font-size:.72rem;}
.etbl th{text-align:right;padding:7px 9px;color:var(--orange);border-bottom:1px solid rgba(196,97,42,.25);font-size:.63rem;font-weight:700;}
.etbl td{padding:6px 9px;color:var(--sand);border-bottom:1px solid rgba(255,255,255,.05);}
.etbl .grp-row td{background:rgba(196,97,42,.12);color:var(--cream);font-weight:700;font-size:.76rem;}
.modal-btns{display:flex;gap:7px;margin-top:13px;flex-wrap:wrap;}
.mbtn{padding:6px 14px;border-radius:8px;border:none;font-family:'Heebo',sans-serif;font-size:.73rem;cursor:pointer;font-weight:600;}
.mbtn-close{background:rgba(255,255,255,.08);color:var(--sand);}
.mbtn-xl{background:var(--sage);color:white;}
.mbtn-close:hover{background:rgba(255,255,255,.14);}

/* ALERTS */
.ia{padding:8px 10px;border-radius:9px;font-size:.68rem;line-height:1.55;margin-bottom:7px;}
.pi{display:flex;align-items:flex-start;gap:8px;padding:6px 0;border-bottom:1px solid rgba(255,255,255,.05);font-size:.76rem;}
.pi:last-child{border-bottom:none;}
.pi strong{color:var(--cream);display:block;}.pi span{color:var(--sand);font-size:.68rem;}
.pii{font-size:.88rem;flex-shrink:0;margin-top:1px;}

::-webkit-scrollbar{width:4px;height:4px;}
::-webkit-scrollbar-track{background:transparent;}
::-webkit-scrollbar-thumb{background:rgba(196,97,42,.3);border-radius:2px;}
</style>
</head>
<body>

<header class="hdr">
  <div class="logo">
    <div class="tm"><span class="w"></span><span class="b"></span><span class="o"></span></div>
    <div><div class="lt">×©×‘×™×œ ×™×©×¨××œ â€“ ×”×“×¨×•×</div><div class="ls">××™×œ×ª â† × ×—×œ ×ª××¨ &nbsp;â€¢&nbsp; ××§×˜×¢×™× 37â€“56</div></div>
  </div>
  <div class="nav">
    <button class="nb on"  onclick="sv('map',this)">ğŸ—ºï¸ ××¤×”</button>
    <button class="nb"     onclick="sv('info',this)">ğŸ“‹ ××™×“×¢</button>
    <button class="nb"     onclick="sv('water',this)">ğŸ’§ ××™×</button>
    <button class="nb"     onclick="sv('angels',this)">ğŸ˜‡ ××œ××›×™×</button>
    <button class="nb"     onclick="sv('gear',this)">ğŸ’ ×¦×™×•×“</button>
    <button class="nb"     onclick="sv('route',this)">ğŸ§­ ××¡×œ×•×œ</button>
  </div>
</header>

<div class="wrap">

<!-- â•â• MAP â•â• -->
<div class="view on" id="vmap">
  <iframe id="spni-map" src="https://experience.arcgis.com/experience/cb82523a09db431f9ed47f5645581be5/" title="×©×‘×™×œ ×™×©×¨××œ" allowfullscreen></iframe>

  <!-- POI icon bar only -->
  <div class="map-icon-bar">
    <button class="mib-btn" id="mib-water" onclick="mibPOI('water',this)"><span class="mi">ğŸ’§</span><span class="ml">××™×</span></button>
    <button class="mib-btn" id="mib-food"  onclick="mibPOI('food',this)"><span class="mi">ğŸ›’</span><span class="ml">××–×•×Ÿ</span></button>
    <button class="mib-btn" id="mib-angel" onclick="mibPOI('angel',this)"><span class="mi">ğŸ˜‡</span><span class="ml">××œ××›×™×</span></button>
    <button class="mib-btn" id="mib-camp"  onclick="mibPOI('camp',this)"><span class="mi">ğŸ•ï¸</span><span class="ml">×œ×™× ×”</span></button>
  </div>

  <!-- Always-visible section panel -->
  <div class="map-sec-panel" id="map-sec-panel">
    <div class="msp-head">
      <span>ğŸ¥¾ ××§×˜×¢×™×</span>
      <div class="dir-toggle">
        <button class="dtb on" id="dir-sn" onclick="setDir('sn')">×“â†’×¦</button>
        <button class="dtb" id="dir-ns" onclick="setDir('ns')">×¦â†’×“</button>
      </div>
    </div>
    <div class="msp-list" id="msp-list"></div>
    <div class="msp-tooltip" id="msp-tooltip" style="display:none;"></div>
  </div>

  <!-- POI overlay panel -->
  <div class="poi-panel" id="poi-panel"></div>
</div>

<!-- â•â• INFO â•â• -->
<div class="view scroll-view" id="vinfo">
  <div class="iw">
    <h1 class="ivt">××™×“×¢ ×©×˜×—</h1>
    <p class="ivs">××“×¨×•× ×œ×¦×¤×•×Ÿ | ××§×˜×¢×™× 56 â† 37 | ×œ×¤×™ SPNI</p>
    <div class="ic">
      <h3>ğŸ¥¾ ×›×œ ×”××§×˜×¢×™× â€“ ×“×¨×•× ×œ×¦×¤×•×Ÿ</h3>
      <div style="overflow-x:auto;"><table class="stbl" id="sec-tbl"></table></div>
    </div>
    <div class="two">
      <div class="ic">
        <h3>ğŸ›’ ×§× ×™×” ×•××¡×¤×§×”</h3>
        <div class="pi"><span class="pii">ğŸª</span><div><strong>××™×œ×ª</strong><span>× ×§×•×“×ª ×¤×ª×™×—×” â€“ ×§× ×• ×”×›×œ ×œ×™××™× ×”×¨××©×•× ×™×!</span></div></div>
        <div class="pi"><span class="pii">ğŸª</span><div><strong>×‘××¨ ××•×¨×” â€“ ××™× ×™××¨×§×˜</strong><span>××§' 53/54 â€“ ×¡×˜×™×™×”, ×™×© ×’× ××™×</span></div></div>
        <div class="pi"><span class="pii">ğŸª</span><div><strong>×¤××¨×§ ×ª×× ×¢</strong><span>××§' 52 â€“ ×—× ×•×ª ×§×˜× ×”, ×›× ×™×¡×” ×—×™× × ×œ×©×‘×™×œ×™×¡×˜×™×</span></div></div>
        <div class="pi"><span class="pii">ğŸª</span><div><strong>×©×—×¨×•×ª â€“ ×©×•×¤×¨×¡×œ ××•× ×œ×™×™×Ÿ</strong><span>××§' 50â€“51 â€“ ×”×–××™× ×• ××¨××© 5 ×™××™×!</span></div></div>
        <div class="pi"><span class="pii">ğŸ˜ï¸</span><div><strong>× ××•×ª ×¡××“×¨</strong><span>××§' 49 â€“ ××¡×¢×“×” ×¦××—×•× ×™×ª, ×œ×™× ×” ×‘×”×ª× ×“×‘×•×ª</span></div></div>
        <div class="pi"><span class="pii">ğŸª</span><div><strong>×¡×¤×™×¨ â€“ ××™× ×™××¨×§×˜</strong><span>××§' 45/46 â€“ ×¡×˜×™×™×” ×§×˜× ×”, ×©×¢×¨ ××—×•×¨×™ ×œ×¨×’×œ×™×</span></div></div>
        <div class="pi"><span class="pii">ğŸ¬</span><div><strong>××¦×¤×” ×¨××•×Ÿ â€“ ×¨××™ ×œ×•×™ + ×—× ×•×™×•×ª</strong><span>××§' 42/43 â€“ ×¢×™×¨ ××œ××”, ×§× ×• ×œ×›××” ×™××™×</span></div></div>
        <div class="ia" style="background:rgba(196,97,42,.08);color:var(--orange);">âš ï¸ ××§×˜×¢×™× 46â€“53 â€“ ×›××¢×˜ ××™×Ÿ ××¡×¤×§×”! ×ª×›× × ×• ××¨××© ×•×©×§×œ×• ×”×–×× ×ª ××¡×¤×§×” ×œ×©×—×¨×•×ª.</div>
      </div>
      <div class="ic">
        <h3>ğŸ•ï¸ ×—× ×™×•× ×™ ×œ×™×œ×” ×¨××©×™×™×</h3>
        <div class="pi"><span class="pii">â›º</span><div><strong>×‘×™×ª ×¡×¤×¨ ×©×“×” ××™×œ×ª</strong><span>××§' 56 â€“ ××™×, ×©×™×¨×•×ª×™×, 60â‚ª/×œ×™×œ×”</span></div></div>
        <div class="pi"><span class="pii">â›º</span><div><strong>×—× ×™×•×Ÿ ×”×¨ ×™×”×•×¨×</strong><span>××§' 55â€“56 â€“ ×¢×•×§×‘ ××™× ×”×¨×˜"×’</span></div></div>
        <div class="pi"><span class="pii">â›º</span><div><strong>×§×™×‘×•×¥ ××œ×™×¤×–</strong><span>××§' 53â€“54 â€“ ×œ×™× ×”, ××§×œ×—×•×ª, ×œ×œ× ×ª×™××•×!</span></div></div>
        <div class="pi"><span class="pii">â›º</span><div><strong>×—× ×™×•×Ÿ ×¨×—× ×¢×ª×§</strong><span>××§' 53 â€“ ×¢×•×§×‘ ××™× ×”×¨×˜"×’</span></div></div>
        <div class="pi"><span class="pii">â›º</span><div><strong>×¤××¨×§ ×ª×× ×¢</strong><span>××§' 52 â€“ ××—×™×¨ ××•×–×œ ×œ×©×‘×™×œ×™×¡×˜×™×</span></div></div>
        <div class="pi"><span class="pii">â›º</span><div><strong>×—××Ÿ ×©×—×¨×•×ª</strong><span>××§' 50â€“51 â€“ ××™× + ×œ×™× ×”</span></div></div>
        <div class="pi"><span class="pii">â›º</span><div><strong>×—× ×™×•×Ÿ ×—×•×œ×•×ª ×›×¡×•×™</strong><span>××§' 49â€“50 â€“ ×—× ×™×•×Ÿ ×œ×™×œ×”, ××™×Ÿ ××™×</span></div></div>
        <div class="pi"><span class="pii">â›º</span><div><strong>×—× ×™×•×Ÿ ×©×™×–×¤×•×Ÿ</strong><span>××§' 49 â€“ ×—× ×™×•×Ÿ ×‘×œ×ª×™ ××•×›×¨×–, ××™×Ÿ ××™×</span></div></div>
        <div class="pi"><span class="pii">â›º</span><div><strong>×©×™×˜×™× â€“ ××©×¨×× ×‘××“×‘×¨</strong><span>××§' 48â€“49 â€“ ×œ×™× ×” ×•××•×›×œ ×‘×ª×©×œ×•×</span></div></div>
        <div class="pi"><span class="pii">â›º</span><div><strong>×—× ×™×•×Ÿ ×¦×™×—×•×¨ (××¤×’×© ×¤××¨×Ÿ)</strong><span>××§' 47â€“48 â€“ ×—× ×™×•×Ÿ ×œ×™×œ×”, ×¢×•×§×‘ ×”×¨×˜"×’</span></div></div>
        <div class="pi"><span class="pii">â›º</span><div><strong>×—× ×™×•×Ÿ × ×—×œ ×‘×¨×§</strong><span>××§' 46â€“47 â€“ ×¢×•×§×‘ ××™× ×”×¨×˜"×’!</span></div></div>
        <div class="pi"><span class="pii">â›º</span><div><strong>×—× ×™×•×Ÿ ×’×‘ ×—×•×œ×™×ª</strong><span>××§' 44â€“45 â€“ ×”×˜×× ×” ×‘×ª×©×œ×•×, ×§"×© ×‘×¨×›×‘ ×©×˜×—</span></div></div>
        <div class="pi"><span class="pii">â›º</span><div><strong>×—× ×™×•×Ÿ ×‘××¨×•×ª</strong><span>××§' 43â€“44 â€“ ×¡×˜×™×™×” 3 ×§"×</span></div></div>
      </div>
    </div>
  </div>
</div>

<!-- â•â• WATER â•â• -->
<div class="view scroll-view" id="vwater">
  <div class="iw">
    <h1 class="ivt">ğŸ’§ ××™× ×‘×©×‘×™×œ</h1>
    <p class="ivs">××“×¨×•× ×œ×¦×¤×•×Ÿ | ××§×•×¨: ×•×™×§×™×©×‘×™×œ (25.11.25)</p>
    <div class="ia" style="background:rgba(91,163,201,.1);color:#8cc9e0;margin-bottom:1rem;">
      âš ï¸ <strong>5â€“7 ×œ×™×˜×¨ ×œ×©×ª×™×” ×œ××“× ×œ×™×•× ×‘×“×¨×•×.</strong> ××™×›×œ×™ ×”×¨×˜"×’ ×–××™× ×™× ×›××¢×˜ ×ª××™×“ (×”×¨ ×™×”×•×¨× â† ××¦×¤×” ×”××›×ª×© ×”×§×˜×Ÿ). ×ª××™×“ ×ª×”×™×” <strong>PLAN B</strong>!
      ××§×˜×¢×™× 46â€“49: <strong style="color:#ff8a8a;">×œ×œ× ××™× ×§×‘×•×¢×™×!</strong> ×”×˜××™× ×• ××¨××© ××• ×•×“××• ×©×™×© ×¢×•×§×‘ ×”×¨×˜"×’.
    </div>
    <div class="ic">
      <h3>ğŸ—ºï¸ × ×§×•×“×•×ª ××™× â€“ ××“×¨×•× ×œ×¦×¤×•×Ÿ</h3>
      <div style="overflow-x:auto;"><table class="wtbl" id="water-tbl"></table></div>
    </div>
    <div class="ic" style="margin-top:1rem;">
      <h3>ğŸ“ ××˜××™× ×™ ××™× ×‘×ª×©×œ×•× â€“ ×”×“×¨×•×</h3>
      <div class="ia" style="background:rgba(196,97,42,.08);color:var(--orange);">
        ×œ×¤× ×™ ×”×™×¦×™××” ×œ×©×‘×™×œ â€“ ×ª×××• ×”×˜×× ×•×ª ××¨××©! ×›×œ ×”××¡×¤×¨×™× ×œ×¤×™ ×•×™×§×™×©×‘×™×œ / ×©×™×¨×•×ª×™× ×‘×ª×©×œ×•×.
      </div>
      <div id="paid-contacts"></div>
    </div>
  </div>
</div>

<!-- â•â• ANGELS â•â• -->
<div class="view scroll-view" id="vangels">
  <div class="iw" style="max-width:900px;">
    <h1 class="ivt">ğŸ˜‡ ××œ××›×™ ×©×‘×™×œ</h1>
    <p class="ivs">××“×¨×•× ×œ×¦×¤×•×Ÿ | ×¢×“×›×•×Ÿ: ×•×™×§×™×©×‘×™×œ + SPNI | ×‘×“×§×• ×œ×¤× ×™ ×›×œ ×™×¦×™××”!</p>
    <div class="ic">
      <div class="ia" style="background:rgba(212,168,67,.1);color:var(--gold);">
        ğŸ“‹ <strong>×›×œ×œ×™ ×‘×¨×–×œ:</strong> ×œ×”×ª×§×©×¨ ×œ×¤×—×•×ª 24 ×©×¢×•×ª ××¨××© (×œ× ××—×¨×™ 20:00) â€¢ ×œ×™×œ×” ××—×“ ×‘×œ×‘×“ â€¢
        ×ª×¨×•××” ~20â‚ª â€¢ ×©×‘×™×œ×™×¡×˜×™× ×‘×¨×¦×£ ×‘×œ×‘×“
      </div>
    </div>
    <div id="angels-list"></div>
    <div class="ic" style="margin-top:.8rem;">
      <h3>ğŸ”— ×”×¨×©×™××” ×”××œ××”</h3>
      <div class="ia" style="background:rgba(107,164,196,.08);color:var(--sky);">
        ×”×¨×©×™××” ×”×¨×©××™×ª ×•×”××¢×•×“×›× ×ª ×¢"×™ ×”××œ××›×™× ×¢×¦××:
        <a href="https://shvil.fandom.com/wiki/%D7%9E%D7%9C%D7%90%D7%9B%D7%99_%D7%A9%D7%91%D7%99%D7%9C_%D7%99%D7%A9%D7%A8%D7%90%D7%9C" target="_blank" style="color:var(--sky);">×•×™×§×™×©×‘×™×œ â€“ ××œ××›×™ ×©×‘×™×œ ×™×©×¨××œ â†’</a>
        &nbsp;|&nbsp;
        <a href="https://www.teva.org.il/israel-national-trail/angels-10" target="_blank" style="color:var(--sky);">SPNI â€“ ××œ××›×™ ×”×“×¨×•× â†’</a>
      </div>
    </div>
  </div>
</div>

<!-- â•â• GEAR â•â• -->
<div class="view scroll-view" id="vgear">
  <div class="gw">
    <h1 class="ivt">ğŸ’ ×¨×©×™××ª ×¦×™×•×“</h1>
    <p class="ivs">âŒ ×”×¡×ª×¨ ×¤×¨×™×˜ | ×§×‘×•×¦×ª×™/××™×©×™ | ××™ ××‘×™× | ×™×™×¦×•× ××™×©×™</p>
    <div class="gt">
      <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap;margin-bottom:7px;">
        <label style="font-size:.8rem;color:var(--sand);">××¡×¤×¨ ××©×ª×ª×¤×™×:</label>
        <input type="number" class="ni" id="np" value="4" min="1" max="12" oninput="rebuildP()">
      </div>
      <div class="pns" id="pnames"></div>
    </div>
    <div id="glist"></div>
    <!-- export footer BELOW all gear -->
    <div class="gfooter">
      <div class="gsi">×¡×”"×›: <strong id="st">0</strong></div>
      <div class="gsi">×”×•×¡×ª×¨×•: <strong id="sh">0</strong></div>
      <div class="gsi">×§×‘×•×¦×”: <strong id="sg">0</strong></div>
      <div class="gsi">××™×©×™: <strong id="sp">0</strong></div>
      <button class="gbtn gbtn-gold" onclick="openExport()">ğŸ“Š ×˜×‘×œ×” ××¡×›××ª</button>
      <button class="gbtn gbtn-sky"  onclick="exportExcelAll()">ğŸ“¥ ×™×™×¦× ×œ××§×¡×œ (×›×•×œ×)</button>
    </div>
  </div>
</div>

<!-- â•â• ROUTE â•â• -->
<div class="view scroll-view" id="vroute" style="padding:.8rem;overflow:hidden;">
  <div style="max-width:1200px;margin:0 auto;width:100%;height:100%;display:flex;flex-direction:column;">
    <div style="text-align:center;margin-bottom:.5rem;flex-shrink:0;">
      <h1 class="ivt" style="font-size:1.3rem;margin-bottom:.1rem;">ğŸ§­ ×”×›× ×ª ××¡×œ×•×œ</h1>
      <p class="ivs" style="margin-bottom:.3rem;font-size:.72rem;">×¡×× ×• ××§×˜×¢×™× â† ×œ×—×¦×• "×”×¢×‘×¨ ×œ×™×•× ×”×œ×™×›×” / ×™×•× ×× ×•×—×”" â† ×¡×™×•×</p>
    </div>
    <div class="route-wizard">
      <!-- LEFT: section list + action buttons -->
      <div class="route-left">
        <div class="sel-count" id="sel-count">0 ××§×˜×¢×™× × ×‘×—×¨×•</div>
        <div class="route-sec-list" id="route-sec-list"></div>
        <div class="route-actions">
          <button class="ract ract-walk" id="btn-add-walk" onclick="addDayFromSel('walk')" disabled>+ ×”×¢×‘×¨ ×œ×™×•× ×”×œ×™×›×”</button>
          <button class="ract ract-rest" onclick="addDayFromSel('rest')">+ ×”×•×¡×£ ×™×•× ×× ×•×—×”</button>
          <div style="height:1px;background:rgba(255,255,255,.07);margin:2px 0;"></div>
          <button class="ract ract-finish" id="btn-finish" onclick="finishRoute()" disabled>×¡×™×•× â† ×¦×¤×” ×‘×˜×‘×œ×”</button>
          <button class="ract ract-reset" onclick="resetRoute()">××¤×¡ ××¡×œ×•×œ</button>
        </div>
      </div>
      <!-- RIGHT: day cards + finish panel -->
      <div class="route-right" id="route-right">
        <div class="route-empty" id="route-empty">
          ×‘×—×¨×• ××§×˜×¢×™× ××”×¨×©×™××” ×•×œ×—×¦×• "×”×¢×‘×¨ ×œ×™×•× ×”×œ×™×›×”"<br>
          <span style="font-size:.65rem;opacity:.5;">× ×™×ª×Ÿ ×œ×”×•×¡×™×£ ×›××” ××§×˜×¢×™× ×©×¨×•×¦×™× ×œ×›×œ ×™×•×</span>
        </div>
      </div>
    </div>
  </div>
</div>

</div><!-- /wrap -->

<!-- GEAR EXPORT MODAL -->
<div class="modal" id="export-modal" style="display:none">
  <div class="modal-inner">
    <h2>ğŸ“Š ×˜×‘×œ×” ××¡×›××ª â€“ ×¦×™×•×“ ×œ×©×‘×™×œ</h2>
    <div id="export-content"></div>
    <div class="modal-btns">
      <button class="mbtn mbtn-close" onclick="closeExport()">âœ• ×¡×’×•×¨</button>
      <button class="mbtn mbtn-xl" onclick="exportExcelAll()">ğŸ“¥ ×™×™×¦× ×”×›×œ ×œ××§×¡×œ</button>
      <div id="per-person-btns" style="display:flex;gap:5px;flex-wrap:wrap;"></div>
    </div>
  </div>
</div>

<!-- ROUTE MODAL -->
<div class="modal" id="route-modal" style="display:none">
  <div class="modal-inner">
    <h2>ğŸ§­ ×˜×‘×œ×ª ××¡×œ×•×œ</h2>
    <div id="route-modal-content"></div>
    <div class="modal-btns">
      <button class="mbtn mbtn-close" onclick="document.getElementById('route-modal').style.display='none'">âœ• ×¡×’×•×¨</button>
    </div>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const SEC_RAW=[
  {num:37,from:'× ×—×œ ×ª××¨',to:'× ×—×œ ×¢×§×¨×‘×™×',km:20,diff:'easy',
   water:['×—× ×™×•×Ÿ ××¦×¤×” ×”××›×ª×© ×”×§×˜×Ÿ â€“ ×”×¨×˜"×’ (×©×ª×™×” ×‘×œ×‘×“)'],
   food:['××™×Ÿ â€“ ×”×›×™× ×• ××¨××©'],angels:[],
   camps:['×—× ×™×•×Ÿ ××¦×¤×” ×”××›×ª×© ×”×§×˜×Ÿ'],
   note:'×›× ×™×¡×” ×œ× ×’×‘. ×’×‘×™ ×¤×¨×¡ â€“ ×˜×™×”×•×¨ ×‘×—×•×¨×£ ×‘×œ×‘×“. ××™×Ÿ ××™× ×‘×“×¨×š!'},
  {num:38,from:'× ×—×œ ×¢×§×¨×‘×™×',to:'××•×¨×•×Ÿ',km:19,diff:'easy',
   water:['××¤×¢×œ ××•×¨×•×Ÿ (×¡×˜×™×™×” ×§×œ×”)','×¢×™×Ÿ ×™×¨×§×¢× â€“ ×˜×™×”×•×¨ ×—×•×¨×£ ×‘×œ×‘×“'],
   food:['××¤×¢×œ ××•×¨×•×Ÿ â€“ ×‘×¡×™×¡×™'],angels:[],
   camps:['×—× ×™×•×Ÿ ×™×¨×§×¢×'],
   note:'××¢×œ×” ×¢×§×¨×‘×™×. âš ï¸ ××™×Ÿ ××™× ×‘×˜×•×—×™× â€“ ×”×’×™×¢×• ××•×›× ×™×.'},
  {num:39,from:'××•×¨×•×Ÿ',to:'× ×—×œ ×¢×¤×¨×Ÿ',km:16,diff:'easy',
   water:['×—× ×™×•×Ÿ ×¢×¤×¨×Ÿ-××“×•×¨ â€“ ×”×˜×× ×” ×‘×ª×©×œ×•×'],
   food:['××™×Ÿ'],angels:[],
   camps:['×—× ×™×•×Ÿ ×¢×¤×¨×Ÿ-××“×•×¨'],
   note:'× ×’×‘ ×©×˜×•×—. ××™×Ÿ ××™× ×§×‘×•×¢×™× â€“ ×”×˜××™× ×• ××¨××©!'},
  {num:40,from:'× ×—×œ ×¢×¤×¨×Ÿ',to:'×—×•×“ ×¢×§×‘',km:19,diff:'medium',
   water:['×—× ×™×•×Ÿ ×—×•×“ ×¢×§×‘ â€“ ×”×¨×˜"×’ (×©×ª×™×” ×‘×œ×‘×“)'],
   food:['××™×Ÿ'],angels:[],
   camps:['×—× ×™×•×Ÿ ×—×•×“ ×¢×§×‘'],
   note:'× ×•×£ ×©×˜×•×—. ×”×¨×˜"×’ ×××™×Ÿ. ×”×’×™×¢×• ×¢× ××™× ×œ××•×¨×š ×›×œ ×”×“×¨×š.'},
  {num:41,from:'×—×•×“ ×¢×§×‘',to:'× ×—×œ ×—×•×•×”',km:18,diff:'medium',
   water:['×—× ×™×•×Ÿ ×—×•×•×” â€“ ×”×˜×× ×” ×‘×ª×©×œ×•×','×’×‘×™ ×—×•×•×” â€“ ×˜×™×”×•×¨ ×—×•×¨×£ ×‘×œ×‘×“'],
   food:['××™×Ÿ'],angels:[],
   camps:['×—× ×™×•×Ÿ ×—×•×•×”'],
   note:'×¢×™×Ÿ ×—×•×•×” â€“ ×¡×˜×™×™×” 800 ×\', ×–×¨×™××” ××™×˜×™×ª. ×”×˜××™× ×• ××¨××©!'},
  {num:42,from:'× ×—×œ ×—×•×•×”',to:'××¦×¤×” ×¨××•×Ÿ',km:18,diff:'medium',
   water:['××¦×¤×” ×¨××•×Ÿ â€“ ×¢×™×¨, ××™× ×‘×©×¤×¢','×‘×¨×– ×›×‘×™×© 40 (×¡×˜×™×™×” 2 ×§"×)'],
   food:['×©×“×” ×‘×•×§×¨ â€“ ×¡×˜×™×™×” 5.5 ×§"×','××¦×¤×” ×¨××•×Ÿ â€“ ×¨××™ ×œ×•×™ + ××¡×¢×“×•×ª'],
   angels:['×¢×¤×¨ ×¨×•×‘×™× ×©×˜×™×™×Ÿ 054-4314040','×©××©×•×Ÿ 054-3451203'],
   camps:['×—× ×™×•×Ÿ ×‘××¨×•×ª (×¡×˜×™×™×” 3 ×§"×)','×‘×™"×¡ ×©×“×” ×”×¨ ×”× ×’×‘ (××¦×¤×” ×¨××•×Ÿ)'],
   note:'× ×•×£ ××›×ª×©. ×©×“×” ×‘×•×§×¨ / ××“×¨×©×ª ×‘×Ÿ ×’×•×¨×™×•×Ÿ ×‘×¡×˜×™×™×” 5.5 ×§"×.'},
  {num:43,from:'××¦×¤×” ×¨××•×Ÿ',to:'× ×—×œ ×’×•×•× ×™×',km:22,diff:'medium',
   water:['××¦×¤×” ×¨××•×Ÿ â€“ ××™× ×‘×©×¤×¢ (×œ×¤× ×™)','×—× ×™×•×Ÿ ×’×•×•× ×™× â€“ ×‘×¨×– ×œ×™×“ ×›×‘×™×© 40','×”×˜×× ×” ×‘×—× ×™×•×Ÿ ×’×•×•× ×™× (×œ× ×—×•×‘×”)'],
   food:['××¦×¤×” ×¨××•×Ÿ â€“ ×¨××™ ×œ×•×™ + ××¡×¢×“×•×ª'],
   angels:['×¢×¤×¨ ×¨×•×‘×™× ×©×˜×™×™×Ÿ 054-4314040','×¢×–×¨×™ ×•×ª×¨×–×” 052-4840324','×œ×™××•×¨ × ×—××” 052-7204600','×‘×™"×¡ ×©×“×” ×”×¨ ×”× ×’×‘ 052-8746406'],
   camps:['×‘×™"×¡ ×©×“×” ×”×¨ ×”× ×’×‘','×—× ×™×•×Ÿ ×’×•×•× ×™× (×¡×”×¨×•× ×™×)'],
   note:'×—×¦×™×™×ª ××›×ª×© ×¨××•×Ÿ. ×‘×™×¡"×© ×”×¨ ×”× ×’×‘ â€“ ×œ×™× ×” ××•××œ×¦×ª.'},
  {num:44,from:'× ×—×œ ×’×•×•× ×™×',to:'×’×‘ ×—×•×œ×™×ª',km:22,diff:'medium',
   water:['×—× ×™×•×Ÿ ×‘××¨×•×ª â€“ ×¡×˜×™×™×” 3 ×§"× ×œ×›×œ ×›×™×•×•×Ÿ','×—× ×™×•×Ÿ ×’×‘ ×—×•×œ×™×ª â€“ ×”×˜×× ×” ×‘×ª×©×œ×•× (×œ× ××™× ×§×‘×•×¢×™×!)'],
   food:['××™×Ÿ'],angels:[],
   camps:['×—× ×™×•×Ÿ ×’×‘ ×—×•×œ×™×ª','×—× ×™×•×Ÿ ×‘××¨×•×ª (×¡×˜×™×™×” 3 ×§"×)'],
   note:'âš ï¸ ×§"×© ×œ×—× ×™×•×Ÿ ×’×‘ ×—×•×œ×™×ª ×‘×¨×›×‘ ×©×˜×— ×‘×œ×‘×“. ××™×Ÿ ××™× ×‘×—× ×™×•×Ÿ â€“ ×”×˜××™× ×• ××¨××©!'},
  {num:45,from:'×’×‘ ×—×•×œ×™×ª',to:'×¡×¤×™×¨',km:20,diff:'medium',
   water:['×¡×¤×™×¨ â€“ ×‘×¨×– ××™× (×¡×˜×™×™×” <1 ×§"×, ×©×¢×¨ ××—×•×¨×™ ×¤×ª×•×—)'],
   food:['×¡×¤×™×¨ â€“ ××™× ×™××¨×§×˜ (×¡×˜×™×™×” ×§×˜× ×”)'],
   angels:['×××¨×—×™× ×‘×¡×¤×™×¨ â€“ ×‘×¨×©×™××ª ×•×™×§×™×©×‘×™×œ'],
   camps:['×—× ×™×•×Ÿ ×¡×¤×™×¨'],
   note:'×™×¨×™×“×” ×œ×¢×¨×‘×”. ×¡×¤×™×¨: ×‘×¨×– + ××™× ×™××¨×§×˜ + ×©×•×¤×¨×¡×œ ××•× ×œ×™×™×Ÿ.'},
  {num:46,from:'×¡×¤×™×¨',to:'×¦×•×§×™×',km:15,diff:'medium',
   water:['×¡×¤×™×¨ â€“ ×˜×¢× ×• ×œ×¤× ×™ ×”×™×¦×™××”!','×¦×•×§×™× â€“ ××™× ×‘×™×™×©×•×‘ (×¡×˜×™×™×”)'],
   food:['×¦×•×§×™× â€“ ×—× ×•×ª ×§×˜× ×” (×¡×˜×™×™×” ×œ×›×‘×™×© ×”×¢×¨×‘×”)'],angels:[],
   camps:['×œ×™× ×ª ×©×˜×— â€“ ××™×Ÿ ×—× ×™×•×Ÿ ××•×›×¨×– ×‘×™× ×™×”×'],
   note:'15 ×§"× ×¢×œ ×©×‘×™×œ + 4 ×§"× ×¢×“ ×¦×•×§×™×. ××™×Ÿ ××™× ×‘×©×‘×™×œ â€“ ×”×›×™× ×• 6 ×œ×™×˜×¨! ×”××œ×¦×ª ×œ×™× ×”: ×‘×™"×¡ ×©×“×” ×—×¦×‘×” (×¡×˜×™×™×”).'},
  {num:47,from:'×¦×•×§×™×',to:'× ×—×œ ×‘×¨×§',km:29,diff:'hard',
   water:['×—× ×™×•×Ÿ × ×—×œ ×‘×¨×§ â€“ ×”×¨×˜"×’ (×©×ª×™×” ×‘×œ×‘×“!)','××™×Ÿ ××™× ×‘×›×œ ×”××§×˜×¢ â€“ ×”×›×™× ×• ××¨××©!'],
   food:['××™×Ÿ'],angels:[],
   camps:['×—× ×™×•×Ÿ ×œ×™×œ×” × ×—×œ ×‘×¨×§ (1.5 ×§"× ××›×‘×™×© 90)','×—× ×™×•×Ÿ ×™×•× â€“ ×™×¦×™××ª ×§× ×™×•×Ÿ ×•×¨×“×™×ª (×§"×©)','××¤×’×© ×¤××¨×Ÿ+×¦×™×—×•×¨ â€“ ×—× ×™×•×Ÿ ×œ×™×œ×” (×§"×©)'],
   note:'29 ×§"×! ××§×˜×¢ ×”××¨×•×š ×‘×™×•×ª×¨. ×§× ×™×•×Ÿ ×‘×¨×§ + ×§× ×™×•×Ÿ ×•×¨×“×™×ª â€“ ×¡×•×œ××•×ª+×—×‘×œ×™×. ×‘×—×•×¨×£ ×™×™×ª×›×Ÿ ×©×—×™×™×” ×‘×’×‘×™×. ××¢×§×¤×™× ×§×™×™××™×.'},
  {num:48,from:'× ×—×œ ×‘×¨×§',to:'× ×—×œ ×¦×™×—×•×¨',km:29,diff:'hard',
   water:['×—× ×™×•×Ÿ ×¦×™×—×•×¨ â€“ ×”×¨×˜"×’ (×©×ª×™×” ×‘×œ×‘×“!)','×—× ×™×•×Ÿ × ×—×œ ×¤××¨×Ÿ+×¦×™×—×•×¨ â€“ ×œ× ×ª××™×“ ×™×© ××™×','××™×Ÿ ××™× ×‘×“×¨×š!'],
   food:['××™×Ÿ'],angels:[],
   camps:['×—× ×™×•×Ÿ ××¤×’×© ×¤××¨×Ÿ+×¦×™×—×•×¨ (×§"×©)','×—× ×™×•×Ÿ ×¦×•××ª ×¦×™×—×•×¨ (×œ×™×“ ×›×‘×™×© 40)'],
   note:'29 ×§"×! ×§× ×™×•×Ÿ ×‘×¨×§ + ×§× ×™×•×Ÿ ×•×¨×“×™×ª â€“ ×¡×•×œ××•×ª, ×—×‘×œ×™×, ×™×™×ª×›×Ÿ ×©×—×™×™×” ×‘×’×‘×™×. ××¢×§×¤×™× ×§×™×™××™×. ××§×˜×¢ ××¨×•×š ×•×ª×•×‘×¢× ×™ ×××•×“.'},
  {num:49,from:'× ×—×œ ×¦×™×—×•×¨',to:'×¦×•××ª ×©×™×–×¤×•×Ÿ',km:14,diff:'medium',
   water:['×—× ×™×•×Ÿ ×¦×™×—×•×¨ â€“ ×”×¨×˜"×’ (×©×ª×™×” ×‘×œ×‘×“!) â€“ ×œ×¤× ×™ ×”×™×¦×™××”','×©×™×˜×™× â€“ ×‘×¨×– ××™× (×¡×˜×™×™×” <1 ×§"×)','××™×Ÿ ××™× ××—×¨×™× ×‘×“×¨×š!'],
   food:['×©×™×˜×™× â€“ ××¨×•×—×” ×¦××—×•× ×™×ª (×¡×˜×™×™×” <1 ×§"×)','× ××•×ª ×¡××“×¨ â€“ ××¡×¢×“×” (×¡×˜×™×™×” ×§×œ×” ×××–×¨×— ×œ×›×‘×™×© 40)'],
   angels:['×©×™×˜×™× â€“ ××©×¨×× ×‘××“×‘×¨ 08-6326508','× ××•×ª ×¡××“×¨ 054-9798919'],
   camps:['×—× ×™×•×Ÿ ×©×™×–×¤×•×Ÿ (×‘×œ×ª×™ ××•×›×¨×–, ×œ×™×“ ×‘×¡×™×¡)','×—× ×™×•×Ÿ ×—×•×œ×•×ª ×›×¡×•×™ (×“×™×•× ×•×ª × ×—×œ ×›×¡×•×™)'],
   note:'××™×©×•×¨×™ ×œ×¨×•×‘. ×©×™×˜×™×: ×œ×™× ×”, ××¨×•×—×”, ×‘×¨×– ××™× â€“ ×¤×—×•×ª ×-1 ×§"× ××”×©×‘×™×œ. × ××•×ª ×¡××“×¨: ×œ×™× ×” ×‘×”×ª× ×“×‘×•×ª, ××¡×¢×“×”.'},
  {num:50,from:'×¦×•××ª ×©×™×–×¤×•×Ÿ',to:'×©×—×¨×•×ª',km:21,diff:'medium',
   water:['×—××Ÿ ×©×—×¨×•×ª â€“ ××™× (×¨××©/×¡×•×£ ××§×˜×¢)','×‘×¨×– ××§×•×¨×•×ª 2.5 ×§"× ××“×¨×•× ×œ×—×•×œ×•×ª ×›×¡×•×™ (150 ×\' ××”×©×‘×™×œ)'],
   food:['×©×—×¨×•×ª â€“ ×©×•×¤×¨×¡×œ ××•× ×œ×™×™×Ÿ (5 ×™××™× ××¨××©!)','×—××Ÿ ×©×—×¨×•×ª â€“ ××–×•×Ÿ ×‘×¡×™×¡×™'],
   angels:['×¢××™×¨/×’×œ×™×” ×©×—×¨×•×ª: camel1985@gmail.com (5 ×™××™× ××¨××©!)'],
   camps:['×—××Ÿ ×©×—×¨×•×ª (×—× ×™×•×Ÿ ×”× ×•×•×“×™×)','×—× ×™×•×Ÿ ×—×•×œ×•×ª ×›×¡×•×™ (×“×™×•× ×•×ª)'],
   note:'××™×©×•×¨×™ ×œ××•×¨×š ×¨×•×‘ ×”×“×¨×š. ×‘×§×¢×ª ×¢×•×‘×“×” ×•××§×“×© ×”× ××¨×™× â€“ × ×§×•×“×•×ª ×¢× ×™×™×Ÿ. ×©×—×¨×•×ª: ××¡×¤×§×” ×•××™×!'},
  {num:51,from:'×©×—×¨×•×ª',to:'×‘××¨ ××™×œ×—×Ÿ',km:17,diff:'medium',
   water:['×—××Ÿ ×©×—×¨×•×ª â€“ ××™× (× ×§×•×“×ª ×”×ª×—×œ×”)','×—× ×™×•×Ÿ ×‘××¨ ××™×œ×—×Ÿ â€“ ×”×¨×˜"×’ (×©×ª×™×” ×‘×œ×‘×“)'],
   food:['×©×—×¨×•×ª â€“ ×©×•×¤×¨×¡×œ ××•× ×œ×™×™×Ÿ (×œ×¤× ×™)'],
   angels:['×¢××™×¨/×’×œ×™×” ×©×—×¨×•×ª: camel1985@gmail.com'],
   camps:['×—× ×™×•×Ÿ ×©×—×¨×•×ª (×—××Ÿ ×”× ×•×•×“×™×)','×—× ×™×•×Ÿ ×‘××¨ ××™×œ×—×Ÿ'],
   note:'×§"×© ×œ×—× ×™×•×Ÿ ×‘××¨ ××™×œ×—×Ÿ ×‘×¨×›×‘ ×©×˜×—. ×‘××¨ ××™×œ×—×Ÿ â€“ ××™× ××œ×™×—×™× ×œ× ×œ×©×ª×™×”! ×”×¨×˜"×’ â€“ ×œ×©×ª×™×”.'},
  {num:52,from:'×‘××¨ ××™×œ×—×Ÿ',to:'×ª×× ×¢',km:12,diff:'medium',
   water:['×¤××¨×§ ×ª×× ×¢ â€“ ××™× ×œ×™×“ ×”××’×'],
   food:['×¤××¨×§ ×ª×× ×¢ â€“ ×—× ×•×ª'],
   angels:['×¤××¨×§ ×ª×× ×¢ 053-2716190'],
   camps:['×¤××¨×§ ×ª×× ×¢ â€“ ××—×™×¨ ××•×–×œ ×œ×©×‘×™×œ×™×¡×˜×™×'],
   note:'×›× ×™×¡×” ×œ×¤××¨×§ ×ª×× ×¢ â€“ ×—×™× × ×œ×©×‘×™×œ×™×¡×˜×™×! ××™× ×œ×™×“ ××¨×›×– ×”××‘×§×¨×™×. 12 ×§"× ×‘×œ×‘×“ â€“ ×™×•× ×§×¦×¨.'},
  {num:53,from:'×ª×× ×¢',to:'×‘××¨ ××•×¨×”',km:13,diff:'medium',
   water:['×—× ×™×•×Ÿ ×¨×—× ×¢×ª×§ â€“ ×”×¨×˜"×’ (×©×ª×™×” ×‘×œ×‘×“)','×‘××¨ ××•×¨×” â€“ ××™× ×™××¨×§×˜ (×¡×˜×™×™×”, ×©×‘×™×œ ×©×—×•×¨+×›×—×•×œ)'],
   food:['×‘××¨ ××•×¨×” â€“ ××™× ×™××¨×§×˜'],
   angels:['×§×™×‘×•×¥ ××œ×™×¤×– 08-6356230 (×œ×œ× ×ª×™××•×!)'],
   camps:['×§×™×‘×•×¥ ××œ×™×¤×– â€“ ×œ×™× ×” ×§××¤×™× ×’','×—× ×™×•×Ÿ ×”×¨ ×™×”×•×¨×'],
   note:'×©×¢×¨ ×‘××¨ ××•×¨×” × ×¢×•×œ â€“ ×”×ª×§×©×¨×• 08-6370247. ×§×™×‘×•×¥ ××œ×™×¤×–: ×œ×™× ×”+××§×œ×—×ª+×§×™×•×¡×§, ×œ×œ× ×ª×™××•× ××¨××©!'},
  {num:54,from:'×‘××¨ ××•×¨×”',to:'×§× ×™×•×Ÿ ×©×—×•×¨×ª',km:20,diff:'hard',
   water:['×—× ×™×•×Ÿ ×”×¨ ×™×”×•×¨× â€“ ×”×¨×˜"×’ (×©×ª×™×” ×‘×œ×‘×“)','××™×Ÿ ××™× ×‘×“×¨×š!'],
   food:['××™×Ÿ'],
   angels:['×§×™×‘×•×¥ ××œ×™×¤×– 08-6356230'],
   camps:['×—× ×™×•×Ÿ ×”×¨ ×™×”×•×¨×'],
   note:'×›× ×™×¡×” ×œ×”×¨×™ ××™×œ×ª. × ×•×£ ××“×™×¨. âš ï¸ ×œ×œ× ××™× ×‘×“×¨×š â€“ ×˜×¢× ×• ×œ×¤× ×™ ×”×™×¦×™××”!'},
  {num:55,from:'×§× ×™×•×Ÿ ×©×—×•×¨×ª',to:'×”×¨ ×™×”×•×¨×',km:13,diff:'hard',
   water:['×—× ×™×•×Ÿ ×”×¨ ×™×”×•×¨× â€“ ×”×¨×˜"×’ (×©×ª×™×” ×‘×œ×‘×“)'],
   food:['××™×Ÿ'],angels:[],
   camps:['×—× ×™×•×Ÿ ×”×¨ ×™×”×•×¨×'],
   note:'×§× ×™×•× ×™× ××¨×”×™×‘×™×. ×œ×•×•×“× ×¢× ×¤×§×— ×˜×¨× ×™×¦×™××”. ×”×¨×™ ××™×œ×ª: × ×•×£ ×’×™××•×œ×•×’×™ ×™×™×—×•×“×™.'},
  {num:56,from:'××™×œ×ª',to:'×”×¨ ×™×”×•×¨×',km:18,diff:'hard',
   water:['××™×œ×ª â€“ ×‘×ª×—×™×œ×”','×‘×™"×¡ ×©×“×” ××™×œ×ª â€“ ××™× ×•×©×™×¨×•×ª×™×'],
   food:['××™×œ×ª â€“ ×¢×™×¨ ××œ××”'],
   angels:['×‘×™"×¡ ×©×“×” ××™×œ×ª 08-6372021','× ×“×‘ 052-5013920'],
   camps:['×‘×™"×¡ ×©×“×” ××™×œ×ª â€“ 60â‚ª/×œ×™×œ×”'],
   note:'××“×¨×•× ×œ×¦×¤×•×Ÿ: ××™×œ×ªâ†’×”×¨ ×™×”×•×¨×. ×™×¨×™×“×” ×ª×œ×•×œ×” 800 ×\' ×”×¤×¨×© ×’×•×‘×” (××¦×¤×•×Ÿ ×œ×“×¨×•×). ××¤×©×¨×•×ª ×§×™×¦×•×¨: ××•× ×™×ª ××”×¨ ×™×•××© ×œ××™×œ×ª.'},
];

// Display order: Sâ†’N = 56 first
let dirSN=true;
let SEC=()=>dirSN?[...SEC_RAW].reverse():SEC_RAW;

// WATER
const WATER=[
  {name:'×‘×™×ª ×¡×¤×¨ ×©×“×” ××™×œ×ª',sec:'××§\' 56',type:'city',dev:'×¢×œ ×”×©×‘×™×œ',info:'××™× ×‘×©×¤×¢, ×¤×ª×•×— 24/7. × ×§×•×“×ª ×¤×ª×™×—×”/×¡×™×•×. 60â‚ª/×œ×™×œ×”.',cache:false,detour:false},
  {name:'×—× ×™×•×Ÿ ×”×¨ ×™×”×•×¨× â€“ ×”×¨×˜"×’',sec:'××§\' 54â€“56',type:'rtg',dev:'×¢×œ ×”×©×‘×™×œ',info:'×¢×•×§×‘ ××™× ×”×¨×˜"×’ â€“ ×œ×©×ª×™×” ×‘×œ×‘×“. ×××™×Ÿ.',cache:false,detour:false},
  {name:'×—× ×™×•×Ÿ ×¨×—× ×¢×ª×§ â€“ ×”×¨×˜"×’',sec:'××§\' 53',type:'rtg',dev:'×¢×œ ×”×©×‘×™×œ',info:'×¢×•×§×‘ ××™× ×”×¨×˜"×’ â€“ ×œ×©×ª×™×” ×‘×œ×‘×“.',cache:false,detour:false},
  {name:'×§×™×‘×•×¥ ××œ×™×¤×–',sec:'××§\' 53',type:'fixed',dev:'×¢×œ ×”×©×‘×™×œ',info:'××™× + ×§××¤×™× ×’. ×œ×œ× ×ª×™××•× ××¨××©. 08-6356230.',cache:false,detour:false},
  {name:'×‘××¨ ××•×¨×” â€“ ××™× ×™××¨×§×˜',sec:'××§\' 53',type:'city',dev:'×©×‘×™×œ ×©×—×•×¨+×›×—×•×œ (×¡×˜×™×™×”)',info:'×©×¢×¨ × ×¢×•×œ â€“ ×”×ª×§×©×¨×• 08-6370247 ×œ×¤× ×™! ××™× + ××™× ×™××¨×§×˜.',cache:false,detour:true},
  {name:'×¤××¨×§ ×ª×× ×¢ â€“ ×œ×™×“ ×”××’×',sec:'××§\' 52',type:'city',dev:'×¢×œ ×”×©×‘×™×œ',info:'××™× ×œ×™×“ ×”××’× (×œ× ×‘×—× ×™×•×Ÿ ×©×‘×•×˜×œ). ×›× ×™×¡×” ×—×™× × ×œ×©×‘×™×œ×™×¡×˜×™×!',cache:false,detour:false},
  {name:'×—× ×™×•×Ÿ ×‘××¨ ××™×œ×—×Ÿ â€“ ×”×¨×˜"×’',sec:'××§\' 51',type:'rtg',dev:'×¢×œ ×”×©×‘×™×œ (×§"×©)',info:'×”×¨×˜"×’ â€“ ×œ×©×ª×™×” ×‘×œ×‘×“! ×§"×©. ×‘××¨ ××™×œ×—×Ÿ ×¢×¦××” â€“ ××œ×™×—, ×œ× ×œ×©×ª×™×”.',cache:false,detour:false},
  {name:'×—××Ÿ ×©×—×¨×•×ª',sec:'××§\' 50â€“51',type:'fixed',dev:'×¢×œ ×”×©×‘×™×œ',info:'××™× ×•×œ×™× ×”. ×©×•×¤×¨×¡×œ ××•× ×œ×™×™×Ÿ ×œ×©×—×¨×•×ª (5 ×™××™× ××¨××©).',cache:false,detour:false},
  {name:'×‘×¨×– ××§×•×¨×•×ª â€“ ×¦×•××ª ×©×—×¨×•×ª',sec:'××§\' 49â€“50',type:'fixed',dev:'150 ×\' ××”×©×‘×™×œ',info:'×‘×¨×– ××™× ××—×•×¥ ×œ×’×“×¨ ××ª×§×Ÿ ××§×•×¨×•×ª. 2.5 ×§"× ××“×¨×•× ×œ×—×•×œ×•×ª ×›×¡×•×™.',cache:false,detour:true},
  {name:'×©×™×˜×™× â€“ ×‘×¨×– ××™×',sec:'××§\' 48â€“49',type:'fixed',dev:'×¡×˜×™×™×” <1 ×§"×',info:'×‘×¨×– ××™× ×‘××©×¨×. ×™×© ×’× ××¨×•×—×” ×¦××—×•× ×™×ª ×•×œ×™× ×” ×‘×ª×©×œ×•×.',cache:false,detour:true},
  {name:'×—× ×™×•×Ÿ ×¦×™×—×•×¨ â€“ ×”×¨×˜"×’',sec:'××§\' 48â€“49',type:'rtg',dev:'×¢×œ ×”×©×‘×™×œ',info:'×¢×•×§×‘ ×”×¨×˜"×’ â€“ ×œ×©×ª×™×” ×‘×œ×‘×“! (×œ×™×“ ×›×‘×™×© 40 ×•× ×—×œ ×¦×™×—×•×¨)',cache:false,detour:false},
  {name:'×—× ×™×•×Ÿ × ×—×œ ×‘×¨×§ â€“ ×”×¨×˜"×’',sec:'××§\' 46â€“47',type:'rtg',dev:'×¢×œ ×”×©×‘×™×œ (1.5 ×§"× ××›×‘×™×© 90)',info:'×¢×•×§×‘ ×”×¨×˜"×’ â€“ ×œ×©×ª×™×” ×‘×œ×‘×“! ×”×—× ×™×•×Ÿ × ×’×™×© ×œ×›×œ ×¨×›×‘.',cache:false,detour:false},
  {name:'×¡×¤×™×¨ â€“ ×‘×¨×– ×•×—× ×™×•×Ÿ',sec:'××§\' 45â€“46',type:'fixed',dev:'×¡×˜×™×™×” <1 ×§"× (×©×¢×¨ ××—×•×¨×™)',info:'×‘×¨×– ××™× + ×—× ×™×•×Ÿ ×©×‘×™×œ×™×¡×˜×™×. 800 ×\' ××“×¨×•× ×œ×™×™×©×•×‘.',cache:false,detour:true},
  {name:'×¦×•×§×™× â€“ ×™×™×©×•×‘',sec:'××§\' 46',type:'city',dev:'×¡×˜×™×™×” ×œ×›×‘×™×© ×”×¢×¨×‘×”',info:'××™× ×‘×™×™×©×•×‘. ×—× ×•×ª ×§×˜× ×”. ×ª×™××•× ××¨××© ×¢× ×ª×•×©×‘×™×.',cache:false,detour:true},
  {name:'×—× ×™×•×Ÿ ×’×‘ ×—×•×œ×™×ª â€“ ×”×˜×× ×”',sec:'××§\' 44â€“45',type:'cache',dev:'×¢×œ ×”×©×‘×™×œ (×§"×©)',info:'×”×˜×× ×” ×‘×ª×©×œ×•× ×‘×œ×‘×“. ××™×Ÿ ××™× ×§×‘×•×¢×™× ×‘×—× ×™×•×Ÿ!',cache:true,detour:false},
  {name:'×—× ×™×•×Ÿ ×‘××¨×•×ª',sec:'××§\' 43â€“44',type:'fixed',dev:'×¡×˜×™×™×” 3 ×§"× ×œ×›×œ ×›×™×•×•×Ÿ',info:'×“×¨×š ×¢×¤×¨ ×˜×•×‘×”.',cache:false,detour:true},
  {name:'×—× ×™×•×Ÿ ×’×•×•× ×™× â€“ ×‘×¨×–',sec:'××§\' 43',type:'fixed',dev:'×œ×™×“ ×›×‘×™×© 40',info:'×‘×¨×– ××™× + ×”×˜×× ×” (×œ× ×—×•×‘×”). ×œ×™×“ ×¤× ×™×ª ×›×‘×™×© 40.',cache:false,detour:false},
  {name:'××¦×¤×” ×¨××•×Ÿ â€“ ×¢×™×¨',sec:'××§\' 42â€“43',type:'city',dev:'×¢×œ ×”×©×‘×™×œ',info:'×¡×•×¤×¨, ×‘×ª×™ ×§×¤×”, ××¡×¢×“×•×ª, ×‘×¨×–. ×§× ×• ×œ×›××” ×™××™×!',cache:false,detour:false},
  {name:'×‘×¨×– ×›×‘×™×© 40 (× ×—×œ × ×§×¨×•×ª)',sec:'××§\' 42',type:'fixed',dev:'×¡×˜×™×™×” 2 ×§"×',info:'×”×œ×™×›×” ××™×©×•×¨×™×ª ×œ×¦×“ ×”×›×‘×™×©.',cache:false,detour:true},
  {name:'×©×“×” ×‘×•×§×¨ / ××“×¨×©×ª ×‘×Ÿ ×’×•×¨×™×•×Ÿ',sec:'××§\' 42',type:'city',dev:'×¡×˜×™×™×” 5.5 ×§"×',info:'××›×•×œ×ª (××—×™×¨×™× ×’×‘×•×”×™×), ××œ××š ×©×‘×™×œ ×‘×¤× ×™××™×™×”.',cache:false,detour:true},
  {name:'×—× ×™×•×Ÿ ×—×•×•×” â€“ ×”×˜×× ×”',sec:'××§\' 41',type:'cache',dev:'×¢×œ ×”×©×‘×™×œ',info:'×”×˜×× ×” ×‘×ª×©×œ×•×. ×’×‘×™ ×—×•×•×” â€“ ×˜×™×”×•×¨ ×‘×—×•×¨×£ ×‘×œ×‘×“.',cache:true,detour:false},
  {name:'×—× ×™×•×Ÿ ×—×•×“ ×¢×§×‘ â€“ ×”×¨×˜"×’',sec:'××§\' 40',type:'rtg',dev:'×¢×œ ×”×©×‘×™×œ',info:'×¢×•×§×‘ ×”×¨×˜"×’ â€“ ×œ×©×ª×™×” ×‘×œ×‘×“!',cache:false,detour:false},
  {name:'×—× ×™×•×Ÿ ×¢×¤×¨×Ÿ-××“×•×¨ â€“ ×”×˜×× ×”',sec:'××§\' 39',type:'cache',dev:'×¢×œ ×”×©×‘×™×œ',info:'×”×˜×× ×” ×‘×ª×©×œ×•×. ××™×Ÿ ××§×•×¨ ××™× ××—×¨!',cache:true,detour:false},
  {name:'××¤×¢×œ ××•×¨×•×Ÿ',sec:'××§\' 38',type:'fixed',dev:'×¡×˜×™×™×” ×§×œ×”',info:'××™× ×–××™× ×™×.',cache:false,detour:true},
  {name:'×—× ×™×•×Ÿ ××¦×¤×” ×”××›×ª×© ×”×§×˜×Ÿ',sec:'××§\' 37',type:'rtg',dev:'×¢×œ ×”×©×‘×™×œ',info:'×¢×•×§×‘ ×”×¨×˜"×’ â€“ ×œ×©×ª×™×” ×‘×œ×‘×“!',cache:false,detour:false},
  {name:'×’×‘×™ ×¤×¨×¡',sec:'××§\' 37',type:'natural',dev:'×¡×˜×™×™×” ×§×œ×”',info:'×˜×™×”×•×¨ ×‘×œ×‘×“ ×× ×”×’×‘×™× ××œ××™× (×—×•×¨×£/××‘×™×‘).',cache:false,detour:true},
];

const PAID=[
  {name:'×—×™×™× ×‘×¨×’×¨',phone:'054-5343797',email:'h.berger@spni.org.il',srv:'×”×˜×× ×•×ª ×§×‘×•×¢×•×ª ××¢×¨×“ ×¢×“ ××™×œ×ª: × ×—×œ ×—×•×•×”, ×’×‘ ×—×•×œ×™×ª, × ×—×œ ××“×•×¨ ×•×¢×•×“. ×”×§×¤×¦×•×ª ×‘×’\'×™×¤. ×™×™×¢×•×¥ + ×ª×›× ×•×Ÿ ××¡×œ×•×œ. ×©×•×œ×— ×¨×©×™××ª ×”×˜×× ×•×ª ×‘××™×™×œ.'},
  {name:'×¢××™×¨/×’×œ×™×” â€“ ×—× ×™×•×Ÿ ×”× ×•×•×“×™× ×©×—×¨×•×ª',phone:'',email:'camel1985@gmail.com',srv:'×œ×™× ×” + ×”×˜×× ×ª ××™× ×•××•×›×œ. ×§× ×™×™×ª ××¦×¨×›×™× ×‘××™×œ×ª ×©×××ª×™× ×™× ×‘×©×—×¨×•×ª. ×”×˜×× ×•×ª 4 ×ª×—× ×•×ª ×‘×”×¨×™ ××™×œ×ª. ×”×–×× ×” 5 ×™××™× ××¨××©.'},
  {name:'×§×™×‘×•×¥ ××œ×™×¤×–',phone:'08-6356230',email:'',srv:'×”×§×¤×¦×•×ª + ×”×˜×× ×•×ª ××™× ×‘×ª×©×œ×•×. ×œ×™× ×” ×§××¤×™× ×’ ×œ×œ× ×ª×™××•× ××¨××©. ××§×œ×—×•×ª, ×©×™×¨×•×ª×™×, ×§×™×•×¡×§.'},
  {name:'×¤××¨×§ ×ª×× ×¢',phone:'053-2716190',email:'',srv:'×œ×™× ×” ×‘××ª×—× ×”××’× ×‘××—×™×¨ ××•×–×œ ×œ×©×‘×™×œ×™×¡×˜×™×. ×”×–×× ×” ××¨××© ×‘××ª×¨ parktimna.co.il'},
  {name:'××©×¨×× ×‘××“×‘×¨ â€“ ×©×™×˜×™×',phone:'08-6326508 | 052-3824617',email:'',srv:'×œ×™× ×” (25â‚ª ×§××¤×™× ×’, 75â‚ª ×—×“×¨) + ××¨×•×—×•×ª. ×‘×¨×– ××™×. ×‘×ª×™××•× ××¨××©.'},
  {name:'×–×™×• ×¡×¤×§×˜×•×¨ â€“ ×—×•×•×ª ×¦×œ ××“×‘×¨ (××¦×¤×” ×¨××•×Ÿ)',phone:'054-6277413',email:'',srv:'×”× ×—×•×ª ×œ×™× ×”, ×”× ×—×™×”, ×œ×•×’×™×¡×˜×™×§×” ×œ××—×–×™×§×™ ×“×¨×›×•×Ÿ ×©"×™.'},
  {name:'××‘×™×˜×œ ×•××™×œ×Ÿ â€“ ×©×“×” ×‘×•×§×¨',phone:'052-5428510 | 08-6532326',email:'',srv:'×”×•×‘×œ×ª ×¦×™×•×“ + ×”×˜×× ×ª ××™×. ×”×–×× ×” ×©×‘×•×¢ ××¨××©.'},
  {name:'×¢××™×¨ ×’×“ × ××•×¨',phone:'054-4956030',email:'',srv:'×”×˜×× ×•×ª + ×”×§×¤×¦×•×ª ×‘××–×•×¨ ×©×—×¨×•×ªâ€“××™×œ×ª.'},
];

const ANGELS=[
  {loc:'××™×œ×ª â€“ ×‘×™×ª ×¡×¤×¨ ×©×“×”',sec:'××§\' 56 | × ×§×•×“×ª ×¤×ª×™×—×”/×¡×™×•×',phone:'08-6372021',srv:'×œ×™× ×” ×§××¤×™× ×’ 60â‚ª/×œ×™×œ×”, ×©×™×¨×•×ª×™×, ××§×œ×—×ª, ×—×©××œ. × ×§×•×“×ª ×—×ª××ª ×“×¨×›×•×Ÿ ×©"×™. × ×™×ª×Ÿ ×œ×”×–××™×Ÿ ××¨×•×—×ª ×‘×•×§×¨ ××¨×•×–×”.',note:'×‘×ª×™××•× ××¨××©. ×œ× ×‘×—×’×™×. ××’×•×“×¨ ×•×××•×‘×˜×—.'},
  {loc:'××™×œ×ª â€“ × ×“×‘',sec:'××§\' 56',phone:'052-5013920',srv:'×œ×™× ×” ×¢×“ 3 ××˜×™×™×œ×™×. ××§×œ×—×ª, ×›×‘×™×¡×”, ×’×–, WIFI. ×œ× ×©×•××¨ ×©×‘×ª.',note:'2 ×¡×˜×•×“× ×˜×™×, ×©×‘×™×œ×™×¡×˜×™× ×œ×©×¢×‘×¨. ××•×•×™×¨×” ××¢×•×œ×”!'},
  {loc:'×§×™×‘×•×¥ ××œ×™×¤×–',sec:'××§\' 53â€“54',phone:'08-6356230',srv:'×œ×™× ×” ×§××¤×™× ×’ ×¢×œ ××–×¨×•× ×™×, ××§×œ×—×•×ª, ×©×™×¨×•×ª×™×, ×§×¤×”/×ª×” ×—×•×¤×©×™, ×§×™×•×¡×§. ×”×§×¤×¦×•×ª + ×”×˜×× ×•×ª ××™× ×‘×ª×©×œ×•×.',note:'×œ×œ× ×ª×™××•× ××¨××© â€“ ×¤×ª×•×— ×ª××™×“!'},
  {loc:'×¤××¨×§ ×ª×× ×¢',sec:'××§\' 52',phone:'053-2716190',srv:'×œ×™× ×” ×‘××ª×—× ×”××’× ×‘××—×™×¨ ××•×–×œ. ×”×–×× ×”: parktimna.co.il',note:'×‘×ª×™××•× ××¨××©.'},
  {loc:'×©×—×¨×•×ª â€“ ×¢××™×¨/×’×œ×™×” (×—× ×™×•×Ÿ ×”× ×•×•×“×™×)',sec:'××§\' 50â€“51',phone:'camel1985@gmail.com',srv:'×œ×™× ×”, ××§×œ×—×ª, ××•×›×œ, ×”×§×¤×¦×•×ª, ×”×˜×× ×ª ××™×. ×§× ×™×™×ª ××–×•×Ÿ ×‘××™×œ×ª ×©×××ª×™×Ÿ ×œ×›×.',note:'×”×–×× ×” 5 ×™××™× ××¨××© ×‘×œ×‘×“! ××™×™×œ ×‘×œ×‘×“.'},
  {loc:'× ××•×ª ×¡××“×¨',sec:'××§\' 49 (×××–×¨×— ×œ×›×‘×™×© 40)',phone:'054-9798919',srv:'×œ×™× ×” ×‘×”×ª× ×“×‘×•×ª. ××¡×¢×“×” ×¦××—×•× ×™×ª. ×××•×¦"×© ×¢×“ ×—××™×©×™.',note:'×‘×‘×§×©×” ×œ×ª×× ××¨××© ×‘×•×•××˜×¡××¤.'},
  {loc:'×©×™×˜×™× â€“ ××©×¨×× ×‘××“×‘×¨',sec:'××§\' 48â€“49',phone:'08-6326508 | 052-3824617',srv:'×œ×™× ×” ×§××¤×™× ×’ (25â‚ª) + ×—×“×¨×™× (75â‚ª). ××¨×•×—×•×ª. ×‘×¨×– ××™× <1 ×§"×. × ×§×•×“×ª ×—×ª××ª ×“×¨×›×•×Ÿ.',note:'×‘×ª×™××•× ××¨××©.'},
  {loc:'××¨×—×‘ ×¢× (××–×•×¨ ×¢×¨×‘×”)',sec:'××§\' 48 (××–×•×¨)',phone:'052-6558582 (××•× ×™×ª)',srv:'1-3 ××˜×™×™×œ×™× ×‘×¨×¦×£. ××§×œ×—×ª, ××™× ×˜×¨× ×˜, ××˜×‘×— ×›×©×¨. ××¨×•×—×•×ª ×©×‘×ª.',note:'×‘×ª×™××•× ×™×•××™×™× ××¨××©.'},
  {loc:'××¦×¤×” ×¨××•×Ÿ â€“ ×¢×¤×¨ ×¨×•×‘×™× ×©×˜×™×™×Ÿ',sec:'××§\' 42â€“43',phone:'054-4314040',srv:'×œ×™× ×”, ××§×œ×—×ª, ××˜×‘×—, ××™× ×˜×¨× ×˜. ×›×•×œ×œ ×©×‘×ª×•×ª. ×¢×“ 2 ××˜×™×™×œ×™×.',note:'×‘×ª×™××•× ××¨××©.'},
  {loc:'××¦×¤×” ×¨××•×Ÿ â€“ ×©××©×•×Ÿ',sec:'××§\' 42â€“43',phone:'054-3451203',srv:'×—×“×¨ ×¤×¨×˜×™ ×¢× ××™×˜×” ×–×•×’×™×ª + ××–×¨×•×Ÿ. ××§×œ×—×ª, ××˜×‘×—, ××™× ×˜×¨× ×˜, ×›×‘×™×¡×”. ×’× ×‘×©×‘×ª×•×ª.',note:'×•×•××˜×¡××¤ ××•×¢×“×£.'},
  {loc:'××¦×¤×” ×¨××•×Ÿ â€“ ×¢×–×¨×™ ×•×ª×¨×–×” ×‘×œ×–×',sec:'××§\' 42â€“43',phone:'052-4840324',srv:'×œ×™× ×”, ××§×œ×—×ª, ××¨×•×—×” ×›×©×¨×”. 2-3 ××˜×™×™×œ×™×. ×©××™×¨×ª ×©×‘×ª.',note:''},
  {loc:'××¦×¤×” ×¨××•×Ÿ â€“ ×œ×™××•×¨ × ×—××”',sec:'××§\' 42â€“43',phone:'052-7204600',srv:'×™×—×™×“×” ×œ-2 ××˜×™×™×œ×™×, ×©×™×¨×•×ª×™× + ××§×œ×—×ª ×¦××•×“×™×. ××©×¤×—×” ×›×©×¨×”.',note:'×•×•××˜×¡××¤ ××•×¢×“×£.'},
  {loc:'×‘×™"×¡ ×©×“×” ×”×¨ ×”× ×’×‘ (××¦×¤×” ×¨××•×Ÿ)',sec:'××§\' 42â€“43',phone:'052-8746406 | 08-6588615',srv:'×§××¤×™× ×’ ×œ×œ× ×ª×©×œ×•×. × ×§×•×“×ª ×—×ª××ª ×“×¨×›×•×Ÿ ×©"×™.',note:''},
  {loc:'×˜×œ×œ×™× â€“ ××•×“×™',sec:'××§\' 42 (×¡×˜×™×™×”)',phone:'052-2304345',srv:'×¢×“ 4 ××˜×™×™×œ×™×. ××¨×•×—×”, ×œ×™× ×”, ××§×œ×—×ª. ××¤×©×¨×•×ª ××™×¡×•×£ ×××–×•×¨ ×©×“×” ×‘×•×§×¨.',note:'×‘×ª×™××•× ××¨××©.'},
];

const POI_DEF={
  water:{icon:'ğŸ’§',color:'#5BA3C9',label:'××§×•×¨×•×ª ××™×',alert:'5â€“7 ×œ×™×˜×¨ ×‘×™×•×. 46â€“49: ×œ×œ× ××™× â€“ ×”×˜××™× ×•!',alertBg:'rgba(91,163,201,.1)',alertClr:'#8cc9e0',
    points:[
      {name:'×‘×™"×¡ ×©×“×” ××™×œ×ª',sec:'××§\' 56',info:'××™× ×‘×©×¤×¢ 24/7',badge:'×××™×Ÿ',bc:'#7A9B6E'},
      {name:'×”×¨ ×™×”×•×¨× â€“ ×”×¨×˜"×’',sec:'××§\' 54â€“56',info:'×¢×•×§×‘ ××™× ×”×¨×˜"×’',badge:'×”×¨×˜"×’',bc:'#5BA3C9'},
      {name:'×¨×—× ×¢×ª×§ â€“ ×”×¨×˜"×’',sec:'××§\' 53',info:'×¢×•×§×‘ ×”×¨×˜"×’',badge:'×”×¨×˜"×’',bc:'#5BA3C9'},
      {name:'×¤××¨×§ ×ª×× ×¢',sec:'××§\' 52',info:'××™× ×œ×™×“ ×”××’×',badge:'×××™×Ÿ',bc:'#7A9B6E'},
      {name:'×‘××¨ ××™×œ×—×Ÿ â€“ ×”×¨×˜"×’',sec:'××§\' 51',info:'×©×ª×™×” ×‘×œ×‘×“! ×§"×©',badge:'×”×¨×˜"×’',bc:'#5BA3C9'},
      {name:'×—××Ÿ ×©×—×¨×•×ª',sec:'××§\' 50â€“51',info:'××™× + ×œ×™× ×”',badge:'×××™×Ÿ',bc:'#7A9B6E'},
      {name:'×‘×¨×– ××§×•×¨×•×ª ×©×—×¨×•×ª',sec:'××§\' 49â€“50',info:'150 ×\' ××”×©×‘×™×œ',badge:'×§×‘×•×¢',bc:'#7A9B6E'},
      {name:'×©×™×˜×™× â€“ ×‘×¨×–',sec:'××§\' 48â€“49',info:'<1 ×§"× ×¡×˜×™×™×”',badge:'×§×‘×•×¢',bc:'#7A9B6E'},
      {name:'×—× ×™×•×Ÿ ×¦×™×—×•×¨ â€“ ×”×¨×˜"×’',sec:'××§\' 47â€“48',info:'×©×ª×™×” ×‘×œ×‘×“!',badge:'×”×¨×˜"×’',bc:'#5BA3C9'},
      {name:'×—× ×™×•×Ÿ ×‘×¨×§ â€“ ×”×¨×˜"×’',sec:'××§\' 46â€“47',info:'×©×ª×™×” ×‘×œ×‘×“!',badge:'×”×¨×˜"×’',bc:'#5BA3C9'},
      {name:'×¡×¤×™×¨ â€“ ×‘×¨×–',sec:'××§\' 45â€“46',info:'<1 ×§"× ×¡×˜×™×™×”',badge:'×××™×Ÿ',bc:'#7A9B6E'},
      {name:'×’×‘ ×—×•×œ×™×ª',sec:'××§\' 44â€“45',info:'×”×˜×× ×” ×‘×ª×©×œ×•×',badge:'×”×˜×× ×”',bc:'#D4A843'},
      {name:'××¦×¤×” ×¨××•×Ÿ',sec:'××§\' 43',info:'×¢×™×¨ ××œ××”',badge:'×××™×Ÿ',bc:'#7A9B6E'},
      {name:'×—×•×“ ×¢×§×‘ â€“ ×”×¨×˜"×’',sec:'××§\' 40',info:'×©×ª×™×” ×‘×œ×‘×“!',badge:'×”×¨×˜"×’',bc:'#5BA3C9'},
    ]},
  food:{icon:'ğŸ›’',color:'#6BAA5A',label:'××¡×¤×§×ª ××–×•×Ÿ',alert:'×ª×›× × ×• 3â€“4 ×™××™× ×‘×™×Ÿ ×¢×¦×™×¨×•×ª. 46-53 ×›××¢×˜ ××™×Ÿ!',alertBg:'rgba(107,170,90,.1)',alertClr:'#9fcf8e',
    points:[
      {name:'××™×œ×ª',sec:'××§\' 56 â€“ ×¤×ª×™×—×”',info:'×¢×™×¨ ××œ××” â€“ ×§× ×• ×”×›×œ!',badge:'××œ×',bc:'#6BAA5A'},
      {name:'××¦×¤×” ×¨××•×Ÿ',sec:'××§\' 43',info:'×¨××™ ×œ×•×™ + ××¡×¢×“×•×ª',badge:'××œ×',bc:'#6BAA5A'},
      {name:'×¡×¤×™×¨',sec:'××§\' 45â€“46',info:'××™× ×™××¨×§×˜',badge:'×‘×¡×™×¡×™',bc:'#888'},
      {name:'×©×—×¨×•×ª',sec:'××§\' 50â€“51',info:'×©×•×¤×¨×¡×œ ××•× ×œ×™×™×Ÿ (5 ×™××™×)',badge:'×”×–×× ×”',bc:'#D4A843'},
      {name:'×©×™×˜×™×',sec:'××§\' 48â€“49',info:'××¨×•×—×” ×¦××—×•× ×™×ª',badge:'××¡×¢×“×”',bc:'#888'},
      {name:'× ××•×ª ×¡××“×¨',sec:'××§\' 49',info:'××¡×¢×“×” + ×œ×™× ×”',badge:'××¡×¢×“×”',bc:'#888'},
      {name:'×¤××¨×§ ×ª×× ×¢',sec:'××§\' 52',info:'×—× ×•×ª ×§×˜× ×”',badge:'×‘×¡×™×¡×™',bc:'#888'},
      {name:'×‘××¨ ××•×¨×”',sec:'××§\' 53',info:'××™× ×™××¨×§×˜ â€“ ×¡×˜×™×™×”',badge:'×‘×¡×™×¡×™',bc:'#888'},
    ]},
  angel:{icon:'ğŸ˜‡',color:'#D4A843',label:'××œ××›×™ ×©×‘×™×œ',alert:'24 ×©×¢×•×ª ××¨××©! ×©×‘×™×œ×™×¡×˜×™× ×‘×¨×¦×£ ×‘×œ×‘×“.',alertBg:'rgba(212,168,67,.1)',alertClr:'#D4A843',
    points:[
      {name:'××™×œ×ª â€“ × ×“×‘',sec:'××§\' 56',info:'×œ×™× ×”, ××§×œ×—×ª, WIFI',badge:'××™×©×™',bc:'#D4A843'},
      {name:'×‘×™"×¡ ×©×“×” ××™×œ×ª',sec:'××§\' 56',info:'60â‚ª, ×©×™×¨×•×ª×™×',badge:'××•×¡×“×™',bc:'#E8873A'},
      {name:'×§×™×‘×•×¥ ××œ×™×¤×–',sec:'××§\' 53â€“54',info:'×œ×œ× ×ª×™××•×!',badge:'×§×™×‘×•×¥',bc:'#5BA3C9'},
      {name:'×©×—×¨×•×ª â€“ ×¢××™×¨',sec:'××§\' 50â€“51',info:'××™×™×œ ×‘×œ×‘×“, 5 ×™××™× ××¨××©',badge:'××™×©×™',bc:'#D4A843'},
      {name:'× ××•×ª ×¡××“×¨',sec:'××§\' 49',info:'×œ×™× ×” ×‘×”×ª× ×“×‘×•×ª',badge:'×§×™×‘×•×¥',bc:'#5BA3C9'},
      {name:'×©×™×˜×™×',sec:'××§\' 48â€“49',info:'25-75â‚ª, ××¨×•×—×•×ª',badge:'×ª×©×œ×•×',bc:'#E8873A'},
      {name:'××¦×¤×” ×¨××•×Ÿ â€“ ×›××” ××œ××›×™×',sec:'××§\' 42â€“43',info:'×¢×“ 3 ××œ××›×™× ×‘×¢×™×¨',badge:'××™×©×™',bc:'#D4A843'},
    ]},
  camp:{icon:'ğŸ•ï¸',color:'#C4612A',label:'×—× ×™×•× ×™ ×œ×™× ×”',alert:'×¨×•×‘ ×”×—× ×™×•× ×™× ×‘×“×¨×•× â€“ ×œ×œ× ××™×! ×”×’×™×¢×• ×¢× ××™×.',alertBg:'rgba(196,97,42,.1)',alertClr:'#E8873A',
    points:[
      {name:'×‘×™"×¡ ×©×“×” ××™×œ×ª',sec:'××§\' 56',info:'×©×™×¨×•×ª×™×, ××™×, 60â‚ª',badge:'××¦×•×™×Ÿ',bc:'#7A9B6E'},
      {name:'×—× ×™×•×Ÿ ×”×¨ ×™×”×•×¨×',sec:'××§\' 55â€“56',info:'×”×¨×˜"×’, × ×•×£',badge:'××™×',bc:'#5BA3C9'},
      {name:'×§×™×‘×•×¥ ××œ×™×¤×–',sec:'××§\' 53â€“54',info:'×œ×œ× ×ª×™××•×, ××§×œ×—×•×ª',badge:'××¢×•×œ×”',bc:'#7A9B6E'},
      {name:'×—× ×™×•×Ÿ ×¨×—× ×¢×ª×§',sec:'××§\' 53',info:'×”×¨×˜"×’',badge:'××™×',bc:'#5BA3C9'},
      {name:'×¤××¨×§ ×ª×× ×¢',sec:'××§\' 52',info:'××—×™×¨ ××•×–×œ',badge:'××™×',bc:'#7A9B6E'},
      {name:'×—××Ÿ ×©×—×¨×•×ª (×—× ×™×•×Ÿ ×”× ×•×•×“×™×)',sec:'××§\' 50â€“51',info:'××™× + ×œ×™× ×”',badge:'××™×',bc:'#7A9B6E'},
      {name:'×—× ×™×•×Ÿ ×—×•×œ×•×ª ×›×¡×•×™',sec:'××§\' 49â€“50',info:'××™×Ÿ ××™×!',badge:'×œ×œ× ××™×',bc:'#888'},
      {name:'×—× ×™×•×Ÿ ×©×™×–×¤×•×Ÿ',sec:'××§\' 49',info:'×‘×œ×ª×™ ××•×›×¨×–, ××™×Ÿ ××™×',badge:'×œ×œ× ××™×',bc:'#888'},
      {name:'×©×™×˜×™× â€“ ××©×¨××',sec:'××§\' 48â€“49',info:'25-75â‚ª, ××¨×•×—×•×ª',badge:'×ª×©×œ×•×',bc:'#E8873A'},
      {name:'×—× ×™×•×Ÿ ×¦×™×—×•×¨ (××¤×’×© ×¤××¨×Ÿ)',sec:'××§\' 47â€“48',info:'×”×¨×˜"×’! ×§"×© ×œ××—×“',badge:'××™×',bc:'#5BA3C9'},
      {name:'×—× ×™×•×Ÿ × ×—×œ ×‘×¨×§',sec:'××§\' 46â€“47',info:'×”×¨×˜"×’! × ×’×™×© ×œ×›×œ ×¨×›×‘',badge:'××™×',bc:'#5BA3C9'},
      {name:'×—× ×™×•×Ÿ ×’×‘ ×—×•×œ×™×ª',sec:'××§\' 44â€“45',info:'×”×˜×× ×”, ×§"×© ×¨×›×‘ ×©×˜×—',badge:'×”×˜×× ×”',bc:'#D4A843'},
      {name:'×—× ×™×•×Ÿ ×‘××¨×•×ª',sec:'××§\' 43â€“44',info:'×¡×˜×™×™×” 3 ×§"×',badge:'×™×© ××™×',bc:'#7A9B6E'},
      {name:'×—× ×™×•×Ÿ ×’×•×•× ×™× (×¡×”×¨×•× ×™×)',sec:'××§\' 43',info:'×‘×¨×– ×œ×™×“ ×›×‘×™×© 40',badge:'×‘×¨×–',bc:'#5BA3C9'},
      {name:'×‘×™"×¡ ×©×“×” ×”×¨ ×”× ×’×‘',sec:'××§\' 42â€“43',info:'×§××¤×™× ×’ ×—×™× ×',badge:'×—×™× ×',bc:'#7A9B6E'},
    ]},
};

// GEAR
const GEAR=[
  {cat:'×‘×™×’×•×“',note:'×¢×“×™×£ ×œ× ×›×•×ª× ×”',items:[
    {n:'×—×•×œ×¦×•×ª (2-3, ××—×ª ××¨×•×›×”)',d:'personal'},{n:'×ª×—×ª×•× ×™× (3-4)',d:'personal'},
    {n:'××›× ×¡×™×™× (2)',d:'personal'},{n:'×’×¨×‘×™×™× ××™×›×•×ª×™×•×ª (3-4 ×–×•×’×•×ª)',d:'personal'},
    {n:'×›×•×‘×¢ ×¨×—×‘ ×©×•×œ×™×™×',d:'personal'},{n:'×¤×œ×™×– + ×›×•×‘×¢ ×¦××¨',d:'personal'},
    {n:'×¡×˜ ×˜×¨××™ + ×œ×™×™× ×¨ ×œ×©×§"×©',d:'personal'},
    {n:'××©×§×¤×™ ×©××©',d:'personal'},{n:'×‘××£ / ×—××¦×•×•××¨',d:'personal'},
    {n:'×›×¤×›×¤×™× / ×¡× ×“×œ×™× (×œ×œ×™× ×”)',d:'personal'},
  ]},
  {cat:'×‘×™×©×•×œ',items:[
    {n:'×¡×™×¨ ×§×˜×Ÿ ×¢× ××›×¡×”',d:'group'},{n:'×‘×œ×•×Ÿ ×’×– ×§×˜×Ÿ',d:'group'},
    {n:'×¨××© ×’×–×™×™×” + ××¦×™×ª',d:'group'},{n:'×¢×¨×›×ª ×ª×‘×œ×™× ×™×',d:'group'},
    {n:'×©××Ÿ ×–×™×ª (×§×˜×Ÿ)',d:'group'},{n:'×›×£ ×œ×‘×™×©×•×œ ×•××›×™×œ×”',d:'personal'},
    {n:'×›×•×¡×•×ª ×œ×§×¤×”/×ª×”',d:'group'},{n:'×¡×›×™×Ÿ ×—×™×ª×•×š',d:'group'},
    {n:'×’×¤×¨×•×¨×™× (×’×™×‘×•×™)',d:'group'},{n:'×©×§×™×•×ª ××˜×•××•×ª ×œ××•×›×œ',d:'group'},
  ]},
  {cat:'×¦×™×•×“ ×—×•×‘×”',items:[
    {n:'2 ××§×œ×•×ª ×”×œ×™×›×” â€“ ×—×•×‘×”!',d:'personal'},
    {n:'×¢×¨×›×ª ×¢×–×¨×” ×¨××©×•× ×”',d:'group'},
    {n:'×¤× ×¡ ×¨××©',d:'personal'},{n:'×˜×œ×¤×•×Ÿ',d:'personal'},
    {n:'××˜×¢×Ÿ × ×™×™×“',d:'personal'},{n:'××–×¨×•×Ÿ ×©×˜×—',d:'personal'},
    {n:'×›×¡×£ + ×ª×¢×•×“×” ××–×”×”',d:'personal'},
  ]},
  {cat:'×›×œ×™ ×¨×—×¦×”',items:[
    {n:'××©×—×” + ××‘×¨×©×ª ×©×™× ×™×™×',d:'personal'},{n:'×“××•×“×•×¨× ×˜',d:'personal'},
    {n:'×§×¨× ×”×’× ×”',d:'personal'},{n:'×¡×‘×•×Ÿ / ×©××¤×•',d:'personal'},
    {n:'××œ×›×•×’\'×œ',d:'personal'},
  ]},
  {cat:'×œ×™× ×” ×•×§×‘×•×¦×ª×™',items:[
    {n:'××•×”×œ / ×˜××¨×¤',d:'group'},{n:'×©×§ ×©×™× ×”',d:'personal'},
    {n:'×©×§×™×•×ª ××©×¤×”',d:'group'},{n:'× ×™×™×¨ ×˜×•××œ×˜',d:'group'},
    {n:'×§×œ×¤×™×',d:'group'},{n:'×©×§×™×•×ª ×–×™×¤-×œ×•×§',d:'group'},
    {n:'××™×ª×¨ ×˜×§×˜×™',d:'group'},{n:'×—×‘×œ ×›×‘×™×¡×”',d:'group'},
    {n:'××™×–×•×œ×™×¨×‘× ×“ / × ×§×¨×•×¤×œ×¡×˜',d:'group'},{n:'×§×•×¦×¥ ×¦×™×¤×•×¨× ×™×™×',d:'group'},
  ]},
  {cat:'×œ× ×—×•×‘×”',items:[
    {n:'×©×œ×•×§×¨',d:'personal'},{n:'××’×Ÿ ×¨×•×— ×œ×’×–×™×™×”',d:'group'},
    {n:'××’×‘×ª',d:'personal'},{n:'××•×–× ×™×•×ª / ×¨××§×•×œ',d:'personal'},
    {n:'×¡×¤×¨ / ×¢×˜ ×•×™×•××Ÿ',d:'personal'},{n:'××©×¨×•×§×™×ª',d:'group'},
    {n:'××¤×” / ×¡×¤×¨ ×©×‘×™×œ',d:'group'},
  ]},
];

const PC=['#E8873A','#5BA3C9','#7A9B6E','#D4A843','#B87BC9','#E05A5A','#5ABDB8','#B8925A','#A0C0E0','#E0A0C0','#70C070','#C07070'];

// â•â• STATE â•â•
let activePOI=null;
let participants=['×“× ×™','×¨×•×Ÿ','× ×•×¢×”','×¢××™×ª'];
let gearState={};
let customItems={};

// â•â• INIT â•â•
window.addEventListener('DOMContentLoaded',()=>{
  buildMapSecPanel();
  buildSecTable();
  buildWaterTable();
  buildPaidContacts();
  buildAngels();
  buildParticipants();
  buildGear();
  initRoute();
});

// â•â• VIEW SWITCH â•â•
function sv(name,btn){
  document.querySelectorAll('.view').forEach(v=>v.classList.remove('on'));
  document.querySelectorAll('.nb').forEach(b=>b.classList.remove('on'));
  document.getElementById('v'+name).classList.add('on');
  if(btn)btn.classList.add('on');
}

// â•â• DIRECTION TOGGLE â•â•
function setDir(d){
  dirSN=(d==='sn');
  document.getElementById('dir-sn').classList.toggle('on',dirSN);
  document.getElementById('dir-ns').classList.toggle('on',!dirSN);
  buildMapSecPanel();
}

// â•â• MAP SEC PANEL â•â•
const SEC_COORDS={
  56:{lat:29.56,lng:34.96},55:{lat:29.65,lng:34.98},54:{lat:29.72,lng:34.97},
  53:{lat:29.82,lng:34.98},52:{lat:29.88,lng:34.98},51:{lat:29.94,lng:35.00},
  50:{lat:30.03,lng:35.03},49:{lat:30.12,lng:35.05},48:{lat:30.22,lng:34.98},
  47:{lat:30.32,lng:34.92},46:{lat:30.40,lng:35.02},45:{lat:30.45,lng:35.06},
  44:{lat:30.52,lng:34.92},43:{lat:30.60,lng:34.82},42:{lat:30.62,lng:34.80},
  41:{lat:30.72,lng:34.77},40:{lat:30.82,lng:34.75},39:{lat:30.92,lng:34.73},
  38:{lat:30.98,lng:35.00},37:{lat:31.05,lng:35.06},
};
function buildMapSecPanel(){
  const dC={easy:'#7A9B6E',medium:'#E8873A',hard:'#E05A5A'};
  const dL={easy:'×§×œ',medium:'×‘×™× ×•× ×™',hard:'×§×©×”'};
  // dirSN=true: display 56 first (south to north direction of travel)
  // Arrow: Sâ†’N means walking FROM southern point (from) TO northern point (to)
  // So label shows: ×-[from(south)] â† [to(north)] = arrow points south (you walk northward)
  document.getElementById('msp-list').innerHTML=SEC().map(s=>`
    <div class="msp-item" id="msp-${s.num}" onclick="mspClick(${s.num})">
      <div class="msp-num">××§×˜×¢ ${s.num}</div>
      <div class="msp-name">${dirSN ? s.from+'â†’'+s.to : s.to+'â†’'+s.from}</div>
      <div class="msp-km">${s.km} ×§"×</div>
      <div class="msp-tags">
        <span class="msp-tag" style="background:${dC[s.diff]}22;color:${dC[s.diff]};border:1px solid ${dC[s.diff]};">${dL[s.diff]}</span>
        ${s.angels.length?`<span class="msp-tag" style="background:rgba(212,168,67,.15);color:var(--gold);border:1px solid rgba(212,168,67,.3);">ğŸ˜‡</span>`:''}
        ${s.water[0].includes('×”×˜×× ×”')?`<span class="msp-tag" style="background:rgba(196,97,42,.2);color:var(--orange);border:1px solid var(--tc);">ğŸ’°</span>`:''}
      </div>
    </div>`).join('');
}

function mspClick(num){
  document.querySelectorAll('.msp-item').forEach(x=>x.classList.remove('on'));
  const el=document.getElementById('msp-'+num);
  if(el){el.classList.add('on');el.scrollIntoView({behavior:'smooth',block:'nearest'});}
  const s=SEC_RAW.find(x=>x.num===num);if(!s)return;
  const dC={easy:'#7A9B6E',medium:'#E8873A',hard:'#E05A5A'};
  const dL={easy:'×§×œ',medium:'×‘×™× ×•× ×™',hard:'×§×©×”'};
  const tip=document.getElementById('msp-tooltip');
  tip.style.display='block';

  // Sâ†’N tooltip: "from" is southern point, "to" is northern
  tip.innerHTML=`
    <div style="font-size:.6rem;color:var(--orange);font-weight:700;margin-bottom:3px;">××§×˜×¢ ${s.num} | ${s.km} ×§"× | <span style="color:${dC[s.diff]}">${dL[s.diff]}</span></div>
    <div style="font-size:.85rem;font-family:'Frank Ruhl Libre',serif;color:var(--cream);margin-bottom:5px;">${s.from} â† ${s.to}</div>
    <div style="font-size:.67rem;color:#8cc9e0;margin-bottom:2px;">ğŸ’§ ${s.water[0]}</div>
    ${s.angels.length?`<div style="font-size:.63rem;color:var(--gold);">ğŸ˜‡ ${s.angels[0]}</div>`:''}
    ${s.camps[0]?`<div style="font-size:.63rem;color:var(--sand);">ğŸ•ï¸ ${s.camps[0]}</div>`:''}
    ${s.note?`<div style="font-size:.62rem;color:rgba(232,213,176,.55);margin-top:4px;">${s.note}</div>`:''}
    <div style="font-size:.58rem;color:rgba(232,213,176,.3);margin-top:5px;">×œ×—×™×¦×” ×¤×•×ª×—×ª ××¤×” ×’×•×’×œ ×œ××§×˜×¢ ×–×”</div>`;

  // Open Google Maps centered on section start coord in new tab
  const coord=SEC_COORDS[num];
  if(coord){
    const iframe=document.getElementById('spni-map');
    iframe.style.boxShadow=`0 0 0 3px var(--tc)`;
    setTimeout(()=>iframe.style.boxShadow='',1800);
    // Add clickable link to open google maps to section location
    const existLink=document.getElementById('msp-gmaps-link');
    if(existLink)existLink.remove();
    const link=document.createElement('a');
    link.id='msp-gmaps-link';
    link.href=`https://maps.google.com/?q=${coord.lat},${coord.lng}&z=13`;
    link.target='_blank';
    link.rel='noopener';
    link.style.cssText='display:block;margin-top:6px;font-size:.65rem;color:var(--sky);text-decoration:none;padding:4px 8px;background:rgba(107,164,196,.1);border:1px solid rgba(107,164,196,.2);border-radius:7px;text-align:center;';
    link.textContent=`×¤×ª×— ××¤×” ×œ××§×˜×¢ ${num} â†`;
    tip.appendChild(link);
  }
}

// â•â• MAP POI â•â•
function mibPOI(type,btn){
  if(activePOI===type){closePOIPanel();return;}
  activePOI=type;
  document.querySelectorAll('.mib-btn').forEach(b=>b.classList.remove('on'));
  btn.classList.add('on');
  const d=POI_DEF[type];
  const cards=d.points.map(p=>`
    <div class="poi-card">
      <div class="pc-name">${d.icon} ${p.name}</div>
      <div class="pc-sec">ğŸ“ ${p.sec}</div>
      <div class="pc-info">${p.info}</div>
      <span class="pc-badge" style="background:${p.bc}22;border:1px solid ${p.bc};color:${p.bc};">${p.badge}</span>
    </div>`).join('');
  const panel=document.getElementById('poi-panel');
  panel.innerHTML=`
    <div class="pp-head">
      <div class="pp-hl"><span class="pp-ico">${d.icon}</span><div><div class="pp-title">${d.label}</div><div class="pp-sub">${d.points.length} × ×§×•×“×•×ª</div></div></div>
      <button class="pp-x" onclick="closePOIPanel()">âœ•</button>
    </div>
    ${cards}
    <div class="pp-alert" style="background:${d.alertBg};color:${d.alertClr};">${d.alert}</div>`;
  panel.style.display='flex';panel.style.flexDirection='column';
}
function closePOIPanel(){
  document.getElementById('poi-panel').style.display='none';
  document.querySelectorAll('.mib-btn').forEach(b=>b.classList.remove('on'));
  activePOI=null;
}

// â•â• INFO TABLE â•â•
function buildSecTable(){
  const dL={easy:'×§×œ',medium:'×‘×™× ×•× ×™',hard:'×§×©×”'},dC={easy:'de',medium:'dm',hard:'dh'};
  // display Sâ†’N (56 first)
  const rows=[...SEC_RAW].reverse();
  document.getElementById('sec-tbl').innerHTML=`
    <thead><tr>
      <th>××§'</th><th style="white-space:nowrap">×-</th><th style="white-space:nowrap">×¢×“</th>
      <th>×§"×</th><th>×§×•×©×™</th><th>××™×</th><th>××œ××›×™×</th><th>×œ×™× ×”</th><th>××–×•×Ÿ</th><th>×”×¢×¨×”</th>
    </tr></thead>
    <tbody>${rows.map(s=>`
      <tr>
        <td style="white-space:nowrap"><strong style="color:var(--orange)">${s.num}</strong></td>
        <td style="white-space:nowrap;color:var(--cream)">${s.from}</td>
        <td style="white-space:nowrap;color:var(--cream)">${s.to}</td>
        <td style="white-space:nowrap">${s.km}</td>
        <td style="white-space:nowrap"><span class="db ${dC[s.diff]}">${dL[s.diff]}</span></td>
        <td style="min-width:120px;line-height:1.65;">${s.water.join('<br>')}</td>
        <td style="min-width:110px;line-height:1.65;">${s.angels.length?s.angels.join('<br>'):'â€“'}</td>
        <td style="min-width:110px;line-height:1.65;">${s.camps.join('<br>')}</td>
        <td style="min-width:90px;line-height:1.65;">${s.food.join('<br>')}</td>
        <td style="min-width:140px;max-width:240px;font-size:.65rem;line-height:1.6;color:rgba(232,213,176,.65);">${s.note||'â€“'}</td>
      </tr>`).join('')}
    </tbody>`;
}

// â•â• WATER TABLE â•â•
function buildWaterTable(){
  const typeMap={
    rtg:{label:'×”×¨×˜"×’',bg:'rgba(91,163,201,.2)',clr:'#5BA3C9'},
    fixed:{label:'×§×‘×•×¢',bg:'rgba(122,155,110,.2)',clr:'#9fcf8e'},
    city:{label:'×™×™×©×•×‘',bg:'rgba(232,135,58,.2)',clr:'var(--orange)'},
    cache:{label:'×”×˜×× ×”',bg:'rgba(196,97,42,.85)',clr:'white'},
    natural:{label:'×˜×™×”×•×¨',bg:'rgba(139,58,26,.2)',clr:'#ff8a5a'},
  };
  document.getElementById('water-tbl').innerHTML=`
    <thead><tr>
      <th>×©× / ××™×§×•×</th><th style="white-space:nowrap">××§×˜×¢</th>
      <th style="min-width:120px">×¡×˜×™×™×”</th><th>×¡×•×’</th><th>×¤×¨×˜×™×</th>
    </tr></thead>
    <tbody>${WATER.map(w=>{
      const t=typeMap[w.type];
      return`<tr ${w.cache?'style="background:rgba(196,97,42,.06);"':''}>
        <td style="color:var(--cream);${w.cache?'font-weight:700;':''};white-space:nowrap">${w.cache?'ğŸ’° ':''} ${w.name}</td>
        <td style="color:var(--orange);white-space:nowrap">${w.sec}</td>
        <td style="${w.detour?'color:#8cc4e8;':''}font-size:.68rem;line-height:1.5;">${w.detour?'â†— ':''} ${w.dev}</td>
        <td><span class="wbadge" style="background:${t.bg};color:${t.clr};white-space:nowrap;">${t.label}</span></td>
        <td style="line-height:1.65;min-width:150px;">${w.info}</td>
      </tr>`;}).join('')}
    </tbody>`;
}

function buildPaidContacts(){
  document.getElementById('paid-contacts').innerHTML=PAID.map(p=>`
    <div class="paid-card">
      <div class="paid-name">${p.name}</div>
      <div style="display:flex;gap:6px;flex-wrap:wrap;margin-top:4px;">
        ${p.phone?`<span class="paid-phone">${p.phone}</span>`:''}
        ${p.email?`<span class="paid-phone" style="background:rgba(107,164,196,.15);border-color:var(--sky);color:var(--sky);">${p.email}</span>`:''}
      </div>
      <div class="paid-srv">${p.srv}</div>
    </div>`).join('');
}

// â•â• ANGELS â•â•
function buildAngels(){
  document.getElementById('angels-list').innerHTML=ANGELS.map(a=>`
    <div class="angel-card">
      <div class="angel-title">${a.loc}</div>
      <div class="angel-sec">${a.sec}</div>
      <div class="angel-info">${a.srv}</div>
      ${a.phone?`<div><span class="angel-phone">${a.phone}</span></div>`:''}
      ${a.note?`<div class="angel-note">${a.note}</div>`:''}
    </div>`).join('');
}

// â•â• GEAR â•â•
function buildParticipants(){
  const n=parseInt(document.getElementById('np').value)||4;
  while(participants.length<n)participants.push(`××˜×™×™×œ ${participants.length+1}`);
  participants=participants.slice(0,n);
  document.getElementById('pnames').innerHTML=participants.map((p,i)=>`
    <div class="pnw">
      <span class="pcd" style="background:${PC[i%PC.length]}"></span>
      <input class="pni" value="${p}" oninput="upName(${i},this.value)">
    </div>`).join('');
}
function rebuildP(){buildParticipants();buildGear();}
function upName(i,v){participants[i]=v;buildGear();updSum();}

function buildGear(){
  let h='';
  GEAR.forEach((cat,ci)=>{
    const emoji={×‘×™×’×•×“:'ğŸ‘•',×‘×™×©×•×œ:'ğŸ³','×¦×™×•×“ ×—×•×‘×”':'ğŸ¥¾','×›×œ×™ ×¨×—×¦×”':'ğŸ§´','×œ×™× ×” ×•×§×‘×•×¦×ª×™':'ğŸ’','×œ× ×—×•×‘×”':'ğŸµ'}[cat.cat]||'ğŸ“¦';
    h+=`<div class="gcat"><h3>${emoji} ${cat.cat}</h3>`;
    if(cat.note)h+=`<div style="font-size:.65rem;color:rgba(232,213,176,.4);margin-bottom:6px;">${cat.note}</div>`;
    cat.items.forEach((item,ii)=>{
      const k=`${ci}-${ii}`;
      if(!gearState[k])gearState[k]={type:item.d,assignee:'',hidden:false,custom:false};
      h+=renderGI(k,item.n,false);
    });
    (customItems[ci]||[]).forEach((item,idx)=>{
      const k=`custom-${ci}-${idx}`;
      if(!gearState[k])gearState[k]={type:'personal',assignee:'',hidden:false,custom:true};
      h+=renderGI(k,item.label,true);
    });
    h+=`<div class="add-item-row">
      <input class="g-add-input" id="ai-${ci}" placeholder="×”×•×¡×™×¤×• ×¦×™×•×“ × ×•×¡×£â€¦" onkeydown="if(event.key==='Enter')addCI(${ci})">
      <button class="g-add-btn" onclick="addCI(${ci})">+ ×”×•×¡×£</button>
    </div></div>`;
  });
  document.getElementById('glist').innerHTML=h;
  updSum();
}

function renderGI(k,label,isCustom){
  const st=gearState[k];
  const ai=participants.indexOf(st.assignee);
  const ac=ai>=0?PC[ai%PC.length]:'var(--sand)';
  const assigneeTag=st.assignee?`<span style="padding:1px 6px;border-radius:7px;background:${ac}22;border:1px solid ${ac};color:${ac};font-size:.6rem;white-space:nowrap;">â— ${st.assignee}</span>`:'';
  return`<div class="gi${st.hidden?' hidden-item':''}">
    <span class="gn ${st.hidden?'':''}"> ${label}</span>
    ${isCustom
      ?`<button class="g-del-btn" onclick="deleteCustom('${k}')">××—×§</button>`
      :`<button class="g-hide-btn" onclick="toggleHide('${k}')">${st.hidden?'â†©':'âŒ'}</button>`
    }
    ${!st.hidden?`
    <div class="gtyp">
      <button class="gtb ${st.type==='group'?'ga':''}" onclick="stype('${k}','group')">×§×‘'</button>
      <button class="gtb ${st.type==='personal'?'pa':''}" onclick="stype('${k}','personal')">××™×©×™</button>
    </div>
    <div class="gas">
      ${st.type==='group'
        ?`<select class="asel" data-key="${k}" onchange="sassy('${k}',this.value)">
            <option value="">â€” ××™ ××‘×™×? â€”</option>
            ${participants.map((p,j)=>`<option value="${p}" ${p===st.assignee?'selected':''}>${p}</option>`).join('')}
          </select>`
        :(st.assignee?assigneeTag:'<span></span>')
      }
    </div>`:''}
  </div>`;
}

function deleteCustom(k){
  const parts=k.split('-');
  const ci=parseInt(parts[1]),idx=parseInt(parts[2]);
  customItems[ci].splice(idx,1);
  delete gearState[k];
  // Rebuild custom keys for this cat
  (customItems[ci]||[]).forEach((_,newIdx)=>{
    const newKey=`custom-${ci}-${newIdx}`;
    if(!gearState[newKey])gearState[newKey]={type:'personal',assignee:'',hidden:false,custom:true};
  });
  buildGear();
}
function addCI(ci){
  const inp=document.getElementById('ai-'+ci);
  const label=(inp.value||'').trim();if(!label)return;
  if(!customItems[ci])customItems[ci]=[];
  customItems[ci].push({label});inp.value='';buildGear();
}
function stype(k,t){gearState[k].type=t;buildGear();}
function sassy(k,v){gearState[k].assignee=v;buildGear();}
function toggleHide(k){gearState[k].hidden=!gearState[k].hidden;if(gearState[k].hidden)gearState[k].assignee='';buildGear();}

function updSum(){
  const a=Object.entries(gearState).filter(([,x])=>!x.hidden);
  const h=Object.values(gearState).filter(x=>x.hidden).length;
  document.getElementById('st').textContent=a.length;
  document.getElementById('sh').textContent=h;
  document.getElementById('sg').textContent=a.filter(([,x])=>x.type==='group').length;
  document.getElementById('sp').textContent=a.filter(([,x])=>x.type==='personal').length;
}

function getLabelForKey(k){
  if(k.startsWith('custom-')){const p=k.split('-');return customItems[parseInt(p[1])]?.[parseInt(p[2])]?.label||'?';}
  const [ci,ii]=k.split('-').map(Number);return GEAR[ci]?.items[ii]?.n||'?';
}
function getCatForKey(k){
  if(k.startsWith('custom-'))return GEAR[parseInt(k.split('-')[1])]?.cat||'××—×¨';
  return GEAR[parseInt(k.split('-')[0])]?.cat||'××—×¨';
}

// â•â• GEAR EXPORT â•â•
function openExport(){
  const byP={};
  Object.entries(gearState).forEach(([k,st])=>{
    if(st.hidden)return;
    const label=getLabelForKey(k),cat=getCatForKey(k);
    const key=st.type==='group'?(st.assignee||'×§×‘×•×¦×” â€“ ×œ× ×”×•×§×¦×”'):(st.assignee||'××™×©×™ â€“ ×œ× ×”×•×§×¦×”');
    if(!byP[key])byP[key]=[];
    byP[key].push({label,cat,type:st.type});
  });
  let h=`<table class="etbl"><thead><tr><th>××—×¨××™</th><th>×¤×¨×™×˜</th><th>×§×˜×’×•×¨×™×”</th><th>×¡×•×’</th></tr></thead><tbody>`;
  Object.entries(byP).forEach(([person,items])=>{
    h+=`<tr class="grp-row"><td colspan="4">${person}</td></tr>`;
    items.forEach(r=>{h+=`<tr><td></td><td>${r.label}</td><td style="opacity:.6">${r.cat}</td><td>${r.type==='group'?"×§×‘×•×¦×ª×™":"××™×©×™"}</td></tr>`;});
  });
  h+='</tbody></table>';
  document.getElementById('export-content').innerHTML=h;
  const pp=document.getElementById('per-person-btns');
  pp.innerHTML=participants.map((p,i)=>`<button class="mbtn" style="background:${PC[i%PC.length]}22;border:1px solid ${PC[i%PC.length]};color:${PC[i%PC.length]};border-radius:8px;padding:6px 12px;cursor:pointer;font-family:Heebo,sans-serif;font-size:.72rem;" onclick="exportExcelPerson('${p}')">××§×¡×œ â€“ ${p}</button>`).join('');
  document.getElementById('export-modal').style.display='flex';
}
function closeExport(){document.getElementById('export-modal').style.display='none';}

function makeXLStyle(wb,ws,headerRow){
  // RTL worksheet
  if(!ws['!sheet'])ws['!sheet']={};
  ws['!sheet'].rightToLeft=true;
  // style headers
  const range=XLSX.utils.decode_range(ws['!ref']||'A1');
  for(let c=range.s.c;c<=range.e.c;c++){
    const addr=XLSX.utils.encode_cell({r:headerRow,c});
    if(!ws[addr])continue;
    ws[addr].s={font:{bold:true,color:{rgb:'C4612A'}},fill:{fgColor:{rgb:'1A0A00'}},alignment:{horizontal:'right'}};
  }
  return ws;
}

function getPersonRows(person){
  const rows=[];
  Object.entries(gearState).forEach(([k,st])=>{
    if(st.hidden)return;
    const label=getLabelForKey(k),cat=getCatForKey(k);
    if(st.type==='personal'&&(!st.assignee||st.assignee===person)){
      rows.push([label,cat,'××™×©×™',person]);
    } else if(st.type==='group'&&st.assignee===person){
      rows.push([label,cat,'×§×‘×•×¦×ª×™ â€“ ××—×¨××™',person]);
    }
  });
  return rows;
}

function exportExcelPerson(person){
  const rows=getPersonRows(person);
  const wsData=[
    [`×¨×©×™××ª ×¦×™×•×“ â€“ ×©×‘×™×œ ×™×©×¨××œ ×”×“×¨×•×`,'','',''],
    [`××©×ª×ª×£: ${person}`,'','',''],
    [],
    ['×¤×¨×™×˜','×§×˜×’×•×¨×™×”','×¡×•×’','××—×¨××™'],
    ...rows
  ];
  const ws=XLSX.utils.aoa_to_sheet(wsData);
  ws['!cols']=[{wch:32},{wch:16},{wch:16},{wch:16}];
  ws['!sheet']={rightToLeft:true};
  // bold header row 3 (0-indexed)
  const hdr=3;
  ['A','B','C','D'].forEach(col=>{
    const addr=col+(hdr+1);
    if(ws[addr])ws[addr].s={font:{bold:true,color:{rgb:'FF8C00'}},fill:{fgColor:{rgb:'180800'}}};
  });
  const wb=XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb,ws,person.substring(0,31));
  XLSX.writeFile(wb,`×¦×™×•×“_×©×‘×™×œ_${person}.xlsx`);
}

function exportExcelAll(){
  const wb=XLSX.utils.book_new();
  participants.forEach(person=>{
    const rows=getPersonRows(person);
    const wsData=[['×¤×¨×™×˜','×§×˜×’×•×¨×™×”','×¡×•×’','××—×¨××™'],...rows];
    const ws=XLSX.utils.aoa_to_sheet(wsData);
    ws['!cols']=[{wch:32},{wch:16},{wch:16},{wch:16}];
    ws['!sheet']={rightToLeft:true};
    ['A','B','C','D'].forEach(col=>{const addr=col+'1';if(ws[addr])ws[addr].s={font:{bold:true,color:{rgb:'FF8C00'}}};});
    XLSX.utils.book_append_sheet(wb,ws,person.substring(0,31));
  });
  // summary sheet
  const allRows=[];
  Object.entries(gearState).forEach(([k,st])=>{
    if(!st.hidden)allRows.push([getLabelForKey(k),getCatForKey(k),st.type==='group'?"×§×‘×•×¦×ª×™":"××™×©×™",st.assignee||'â€“']);
  });
  const wsAll=XLSX.utils.aoa_to_sheet([['×¤×¨×™×˜','×§×˜×’×•×¨×™×”','×¡×•×’','××—×¨××™'],...allRows]);
  wsAll['!cols']=[{wch:32},{wch:16},{wch:12},{wch:18}];
  wsAll['!sheet']={rightToLeft:true};
  ['A','B','C','D'].forEach(col=>{const addr=col+'1';if(wsAll[addr])wsAll[addr].s={font:{bold:true,color:{rgb:'FF8C00'}}};});
  XLSX.utils.book_append_sheet(wb,wsAll,'×¡×™×›×•× ×›×•×œ×œ');
  XLSX.writeFile(wb,'×¦×™×•×“_×©×‘×™×œ_×™×©×¨××œ.xlsx');
}

// â•â• ROUTE PLANNER â€“ wizard style â•â•
let routeDays=[];
let selSecs=new Set();

function initRoute(){
  buildRouteSectionList();
  renderDays();
}

function buildRouteSectionList(){
  const ordered=[...SEC_RAW].reverse();
  document.getElementById('route-sec-list').innerHTML=ordered.map(s=>`
    <div class="rsec-item ${selSecs.has(s.num)?'sel':''}" id="rsec-${s.num}" onclick="toggleRouteSec(${s.num})">
      <div class="rsec-cb"><span class="rsec-ck">âœ“</span></div>
      <div style="flex:1;min-width:0;">
        <div style="display:flex;align-items:baseline;gap:4px;">
          <span class="rsec-num">${s.num}</span>
          <span class="rsec-name" style="overflow:hidden;text-overflow:ellipsis;white-space:nowrap;">${s.from}â†’${s.to}</span>
        </div>
        <span class="rsec-km">${s.km} ×§"×</span>
      </div>
    </div>`).join('');
  updateSelCount();
}

function toggleRouteSec(num){
  if(selSecs.has(num))selSecs.delete(num);
  else selSecs.add(num);
  const el=document.getElementById('rsec-'+num);
  if(el)el.classList.toggle('sel',selSecs.has(num));
  updateSelCount();
}

function updateSelCount(){
  const n=selSecs.size;
  document.getElementById('sel-count').textContent=n?`${n} ××§×˜×¢×™× × ×‘×—×¨×•`:'×‘×—×¨×• ××§×˜×¢×™× ××”×¨×©×™××”';
  const btn=document.getElementById('btn-add-walk');
  if(btn)btn.disabled=(n===0);
}

function addDayFromSel(type){
  const secs=type==='walk'?[...selSecs].sort((a,b)=>a-b):[];
  let gapDesc='';
  const prevWalkDay=[...routeDays].reverse().find(d=>d.type==='walk'&&d.secs.length>0);
  if(type==='walk'&&prevWalkDay&&secs.length){
    const lastPrev=Math.max(...prevWalkDay.secs);
    const firstCur=Math.min(...secs);
    if(Math.abs(lastPrev-firstCur)>1) gapDesc=`__GAP__${lastPrev}_${firstCur}`;
  }
  routeDays.push({type,secs,note:'',gapDesc,gapNote:''});
  selSecs.clear();
  buildRouteSectionList();
  renderDays();
  const btnF=document.getElementById('btn-finish');
  if(btnF)btnF.disabled=routeDays.filter(d=>d.type==='walk'&&d.secs.length).length===0;
}

function deleteDay(idx){
  routeDays.splice(idx,1);
  renderDays();
  const btnF=document.getElementById('btn-finish');
  if(btnF)btnF.disabled=routeDays.filter(d=>d.type==='walk'&&d.secs.length).length===0;
}

function renderDays(){
  const container=document.getElementById('route-right');
  const emptyEl=document.getElementById('route-empty');
  container.querySelectorAll('.route-day-card,.route-finish-panel').forEach(e=>e.remove());
  if(!routeDays.length){if(emptyEl)emptyEl.style.display='block';return;}
  if(emptyEl)emptyEl.style.display='none';
  routeDays.forEach((day,idx)=>{
    const div=document.createElement('div');
    div.className='route-day-card';
    const dayKm=day.secs.reduce((s,n)=>{const sec=SEC_RAW.find(x=>x.num===n);return s+(sec?sec.km:0);},0);
    let gapHTML='';
    if(day.gapDesc&&day.gapDesc.startsWith('__GAP__')){
      const parts=day.gapDesc.replace('__GAP__','').split('_');
      gapHTML=`<div class="rdc-gap">âš ï¸ ×“×™×œ×•×’ ×-${parts[0]} ×œ-${parts[1]} â€“ ×›×™×¦×“ ×”×’×¢×ª×?
        <input placeholder="×œ×“×•×’××”: × ×¡×™×¢×” ×‘×¨×›×‘ ×œ× ×§×•×“×ª ×”×¤×ª×™×—×”..." value="${day.gapNote||''}" oninput="routeDays[${idx}].gapNote=this.value">
      </div>`;
    }
    const secChips=day.secs.map(n=>{const s=SEC_RAW.find(x=>x.num===n);return`<span class="rdc-chip">${n} ${s?s.from.substring(0,6):''}â€¦</span>`;}).join('');
    let infoLines='';
    if(day.type==='walk'&&day.secs.length){
      const waters=[...new Set(day.secs.flatMap(n=>SEC_RAW.find(x=>x.num===n)?.water||[]))];
      const camps=SEC_RAW.find(x=>x.num===Math.max(...day.secs))?.camps||[];
      const food=[...new Set(day.secs.flatMap(n=>SEC_RAW.find(x=>x.num===n)?.food||[]))].filter(f=>f!=='××™×Ÿ');
      const angels=[...new Set(day.secs.flatMap(n=>SEC_RAW.find(x=>x.num===n)?.angels||[]))];
      if(waters[0])infoLines+=`<div>ğŸ’§ ${waters[0]}</div>`;
      if(camps[0])infoLines+=`<div>ğŸ•ï¸ ${camps[0]}</div>`;
      if(food[0])infoLines+=`<div>ğŸ›’ ${food[0]}</div>`;
      if(angels[0])infoLines+=`<div>ğŸ˜‡ ${angels[0]}</div>`;
    }
    div.innerHTML=`
      <div class="rdc-hdr">
        <span class="rdc-day">×™×•× ${idx+1}</span>
        <span class="rdc-type-badge ${day.type==='walk'?'rdc-walk':'rdc-rest'}">${day.type==='walk'?'×”×œ×™×›×”':'×× ×•×—×”'}</span>
        ${day.type==='walk'&&dayKm>0?`<span class="rdc-km">${dayKm} ×§"×</span>`:''}
        <button class="rdc-del" onclick="deleteDay(${idx})" title="××—×§ ×™×•×">âœ•</button>
      </div>
      ${gapHTML}
      ${day.type==='walk'?`<div class="rdc-secs">${secChips||'<span style="font-size:.65rem;opacity:.4;">×¨×™×§</span>'}</div>`:'<div style="font-size:.72rem;color:var(--gold);padding:3px 0;">×™×•× ×× ×•×—×” / ××§×œ×•×</div>'}
      ${infoLines?`<div class="rdc-info">${infoLines}</div>`:''}
      <textarea class="rdc-note" rows="1" placeholder="×”×¢×¨×•×ª ×œ×™×•× ${idx+1}..." oninput="routeDays[${idx}].note=this.value">${day.note}</textarea>`;
    container.appendChild(div);
  });
}

function finishRoute(){
  const container=document.getElementById('route-right');
  container.querySelectorAll('.route-finish-panel').forEach(e=>e.remove());
  const walkDays=routeDays.filter(d=>d.type==='walk');
  const allSecs=[...new Set(walkDays.flatMap(d=>d.secs))];
  const totalKm=allSecs.reduce((s,n)=>{const sec=SEC_RAW.find(x=>x.num===n);return s+(sec?sec.km:0);},0);
  const restDays=routeDays.filter(d=>d.type==='rest').length;
  const panel=document.createElement('div');
  panel.className='route-finish-panel';
  panel.innerHTML=`
    <div class="rfp-stats">
      <div class="rfp-stat"><div class="rfp-val">${totalKm}</div><div class="rfp-lbl">×§×™×œ×•××˜×¨</div></div>
      <div class="rfp-stat"><div class="rfp-val">${routeDays.length}</div><div class="rfp-lbl">×™××™× ×¡×”"×›</div></div>
      <div class="rfp-stat"><div class="rfp-val">${walkDays.length}</div><div class="rfp-lbl">×™××™ ×”×œ×™×›×”</div></div>
      <div class="rfp-stat"><div class="rfp-val">${restDays}</div><div class="rfp-lbl">×™××™ ×× ×•×—×”</div></div>
      <div class="rfp-stat"><div class="rfp-val">${allSecs.length}</div><div class="rfp-lbl">××§×˜×¢×™×</div></div>
    </div>
    <div class="rfp-btns">
      <button class="gbtn gbtn-gold" onclick="openRouteModal()">ğŸ“Š ×˜×‘×œ×ª ××¡×œ×•×œ ××œ××”</button>
      <button class="gbtn gbtn-sky"  onclick="exportRouteXL()">ğŸ“¥ ×™×™×¦×•× ×œ××§×¡×œ</button>
    </div>
    <div class="route-map-embed">
      <iframe src="https://experience.arcgis.com/experience/cb82523a09db431f9ed47f5645581be5/" title="××¤×ª ××¡×œ×•×œ" allowfullscreen></iframe>
    </div>`;
  container.appendChild(panel);
  panel.scrollIntoView({behavior:'smooth'});
}

function resetRoute(){
  if(!confirm('×œ××¤×¡ ××ª ×”××¡×œ×•×œ ×œ×—×œ×•×˜×™×Ÿ?'))return;
  routeDays=[];selSecs.clear();
  buildRouteSectionList();
  renderDays();
  const btnF=document.getElementById('btn-finish');
  if(btnF)btnF.disabled=true;
}

function openRouteModal(){
  let h=`<table class="etbl" style="font-size:.67rem;">
    <thead><tr><th>×™×•×</th><th>×¡×•×’</th><th>××§×˜×¢×™×</th><th>×§"×</th><th>××™×</th><th>××–×•×Ÿ/××¡×¤×§×”</th><th>×œ×™× ×”</th><th>××œ××›×™×</th><th>××¢×‘×¨/×”×¢×¨×•×ª</th></tr></thead><tbody>`;
  routeDays.forEach((day,idx)=>{
    if(day.type==='rest'){
      h+=`<tr><td>×™×•× ${idx+1}</td><td><span style="color:var(--gold)">×× ×•×—×”</span></td><td colspan="7">${day.note||'â€“'}</td></tr>`;
      return;
    }
    if(!day.secs.length){h+=`<tr><td>×™×•× ${idx+1}</td><td>×”×œ×™×›×”</td><td colspan="7">×¨×™×§</td></tr>`;return;}
    const dayKm=day.secs.reduce((s,n)=>{const sec=SEC_RAW.find(x=>x.num===n);return s+(sec?sec.km:0);},0);
    const waters=[...new Set(day.secs.flatMap(n=>SEC_RAW.find(x=>x.num===n)?.water||[]))];
    const food=[...new Set(day.secs.flatMap(n=>SEC_RAW.find(x=>x.num===n)?.food||[]))].filter(f=>f!=='××™×Ÿ');
    const camps=SEC_RAW.find(x=>x.num===Math.max(...day.secs))?.camps||[];
    const angels=[...new Set(day.secs.flatMap(n=>SEC_RAW.find(x=>x.num===n)?.angels||[]))];
    const gapNote=day.gapDesc?.startsWith('__GAP__')&&day.gapNote?`××¢×‘×¨: ${day.gapNote}`:'';
    const noteCell=[gapNote,day.note].filter(Boolean).join(' | ');
    h+=`<tr>
      <td>×™×•× ${idx+1}</td><td>×”×œ×™×›×”</td>
      <td>${day.secs.join(', ')}</td>
      <td style="font-weight:700;color:var(--orange)">${dayKm}</td>
      <td style="font-size:.63rem">${waters.join('<br>')||'â€“'}</td>
      <td style="font-size:.63rem">${food.join('<br>')||'â€“'}</td>
      <td style="font-size:.63rem">${camps.join('<br>')||'×©×˜×—'}</td>
      <td style="font-size:.63rem">${angels.join('<br>')||'â€“'}</td>
      <td>${noteCell||'â€“'}</td>
    </tr>`;
  });
  const allSecs=[...new Set(routeDays.filter(d=>d.type==='walk').flatMap(d=>d.secs))];
  const totalKm=allSecs.reduce((s,n)=>{const sec=SEC_RAW.find(x=>x.num===n);return s+(sec?sec.km:0);},0);
  h+=`<tr style="background:rgba(196,97,42,.12);"><td colspan="3"><strong>×¡×”"×›</strong></td><td><strong style="color:var(--orange)">${totalKm} ×§"×</strong></td><td colspan="5">${routeDays.length} ×™××™× | ${routeDays.filter(d=>d.type==='walk').length} ×™××™ ×”×œ×™×›×”</td></tr>`;
  h+='</tbody></table>';
  document.getElementById('route-modal-content').innerHTML=h;
  document.getElementById('route-modal').style.display='flex';
}

function exportRouteXL(){
  const wsData=[['×©×‘×™×œ ×™×©×¨××œ â€“ ××¡×œ×•×œ ××™×©×™','','','','','','','',''],[]
    ,['×™×•×','×¡×•×’','××§×˜×¢×™×','×§"×','××™×','××–×•×Ÿ/××¡×¤×§×”','×œ×™× ×”','××œ××›×™×','×”×¢×¨×•×ª/××¢×‘×¨']];
  routeDays.forEach((day,idx)=>{
    if(day.type==='rest'){wsData.push([`×™×•× ${idx+1}`,'×× ×•×—×”','â€“','â€“','â€“','â€“','â€“','â€“',day.note||'']);return;}
    if(!day.secs.length){wsData.push([`×™×•× ${idx+1}`,'×”×œ×™×›×”','×¨×™×§','','','','','','']);return;}
    const dayKm=day.secs.reduce((s,n)=>{const sec=SEC_RAW.find(x=>x.num===n);return s+(sec?sec.km:0);},0);
    const waters=[...new Set(day.secs.flatMap(n=>SEC_RAW.find(x=>x.num===n)?.water||[]))];
    const food=[...new Set(day.secs.flatMap(n=>SEC_RAW.find(x=>x.num===n)?.food||[]))].filter(f=>f!=='××™×Ÿ');
    const camps=SEC_RAW.find(x=>x.num===Math.max(...day.secs))?.camps||[];
    const angels=[...new Set(day.secs.flatMap(n=>SEC_RAW.find(x=>x.num===n)?.angels||[]))];
    const gapNote=day.gapDesc?.startsWith('__GAP__')&&day.gapNote?`××¢×‘×¨: ${day.gapNote}`:'';
    const noteCell=[gapNote,day.note].filter(Boolean).join(' | ');
    wsData.push([`×™×•× ${idx+1}`,'×”×œ×™×›×”',day.secs.join(', '),dayKm,waters.join(' | ')||'â€“',food.join(' | ')||'â€“',camps.join(' | ')||'×©×˜×—',angels.join(' | ')||'â€“',noteCell||'']);
  });
  const allSecs=[...new Set(routeDays.filter(d=>d.type==='walk').flatMap(d=>d.secs))];
  const totalKm=allSecs.reduce((s,n)=>{const sec=SEC_RAW.find(x=>x.num===n);return s+(sec?sec.km:0);},0);
  wsData.push([],[`×¡×™×›×•×: ${totalKm} ×§"× | ${routeDays.length} ×™××™× | ${routeDays.filter(d=>d.type==='walk').length} ×™××™ ×”×œ×™×›×”`]);
  const ws=XLSX.utils.aoa_to_sheet(wsData);
  ws['!cols']=[{wch:8},{wch:10},{wch:18},{wch:6},{wch:28},{wch:22},{wch:24},{wch:22},{wch:30}];
  ws['!sheet']={rightToLeft:true};
  ['A','B','C','D','E','F','G','H','I'].forEach(col=>{
    const addr=col+'3';
    if(ws[addr])ws[addr].s={font:{bold:true,color:{rgb:'FF8C00'}},fill:{fgColor:{rgb:'180800'}}};
  });
  const wb=XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb,ws,'××¡×œ×•×œ');
  XLSX.writeFile(wb,'××¡×œ×•×œ_×©×‘×™×œ_×™×©×¨××œ.xlsx');
}

</script>
</body>
</html>
